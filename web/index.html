<!DOCTYPE html>
<html lang="en" data-theme="ink">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
<title>StudyBot</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   RESET
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:inherit}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   THEMES  (6 total)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
:root{--header-h:58px;--sb-w:240px;--ap-w:260px;--nav-h:62px;}

[data-theme="ink"]{
  --bg:#0d0d12;--s1:#141419;--s2:#1b1b23;--s3:#22222d;
  --bd1:rgba(255,255,255,0.07);--bd2:rgba(255,255,255,0.13);
  --tx1:#ebebf2;--tx2:rgba(235,235,242,0.56);--tx3:rgba(235,235,242,0.3);
  --ac:#b6f040;--ac2:#3ddaf5;--ac3:#f040a2;
  --ad:rgba(182,240,64,0.12);--ab:rgba(182,240,64,0.28);
  --sh:0 20px 60px rgba(0,0,0,0.55);--cs:0 4px 16px rgba(0,0,0,0.35);
}
[data-theme="paper"]{
  --bg:#f3ede1;--s1:#faf7f0;--s2:#ede5d6;--s3:#e0d7c5;
  --bd1:rgba(0,0,0,0.07);--bd2:rgba(0,0,0,0.14);
  --tx1:#1a1609;--tx2:rgba(26,22,9,0.54);--tx3:rgba(26,22,9,0.32);
  --ac:#c03b12;--ac2:#1258c0;--ac3:#8a12c0;
  --ad:rgba(192,59,18,0.1);--ab:rgba(192,59,18,0.26);
  --sh:0 20px 60px rgba(0,0,0,0.12);--cs:0 2px 10px rgba(0,0,0,0.09);
}
[data-theme="slate"]{
  --bg:#0c1018;--s1:#141c26;--s2:#1c2535;--s3:#232e42;
  --bd1:rgba(255,255,255,0.07);--bd2:rgba(255,255,255,0.13);
  --tx1:#ccd8ed;--tx2:rgba(204,216,237,0.54);--tx3:rgba(204,216,237,0.29);
  --ac:#4ea4ff;--ac2:#4dde7a;--ac3:#ff7152;
  --ad:rgba(78,164,255,0.12);--ab:rgba(78,164,255,0.28);
  --sh:0 20px 60px rgba(0,0,0,0.5);--cs:0 4px 16px rgba(0,0,0,0.3);
}
[data-theme="rose"]{
  --bg:#110909;--s1:#1c0e0e;--s2:#251414;--s3:#2f1b1b;
  --bd1:rgba(255,205,205,0.07);--bd2:rgba(255,205,205,0.14);
  --tx1:#f2e9e9;--tx2:rgba(242,233,233,0.54);--tx3:rgba(242,233,233,0.29);
  --ac:#ff5f7e;--ac2:#ffac5f;--ac3:#c05fff;
  --ad:rgba(255,95,126,0.12);--ab:rgba(255,95,126,0.28);
  --sh:0 20px 60px rgba(0,0,0,0.55);--cs:0 4px 16px rgba(0,0,0,0.35);
}
[data-theme="mint"]{
  --bg:#ecf4ef;--s1:#ffffff;--s2:#dff0e8;--s3:#cfe6d9;
  --bd1:rgba(0,0,0,0.07);--bd2:rgba(0,0,0,0.14);
  --tx1:#091e12;--tx2:rgba(9,30,18,0.54);--tx3:rgba(9,30,18,0.32);
  --ac:#077a50;--ac2:#07619a;--ac3:#7a0770;
  --ad:rgba(7,122,80,0.1);--ab:rgba(7,122,80,0.24);
  --sh:0 20px 60px rgba(0,0,0,0.1);--cs:0 2px 10px rgba(0,0,0,0.08);
}
[data-theme="dusk"]{
  --bg:#0a080f;--s1:#120f1e;--s2:#1a1628;--s3:#221c33;
  --bd1:rgba(208,188,255,0.07);--bd2:rgba(208,188,255,0.14);
  --tx1:#eeeaf8;--tx2:rgba(238,234,248,0.54);--tx3:rgba(238,234,248,0.29);
  --ac:#bf84ff;--ac2:#5eedff;--ac3:#ff5f7e;
  --ad:rgba(191,132,255,0.12);--ab:rgba(191,132,255,0.28);
  --sh:0 20px 60px rgba(0,0,0,0.6);--cs:0 4px 16px rgba(0,0,0,0.4);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   BASE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
html{scroll-behavior:smooth;height:100%}
body{
  background:var(--bg);color:var(--tx1);
  font-family:'DM Sans',sans-serif;font-size:15px;
  line-height:1.55;min-height:100%;
  -webkit-font-smoothing:antialiased;
  transition:background .3s,color .3s;
  overflow:hidden;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   AUTH SCREEN
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#authScreen{
  position:fixed;inset:0;z-index:500;
  display:flex;align-items:center;justify-content:center;
  background:var(--bg);padding:20px;overflow-y:auto;
}
.aw{width:100%;max-width:390px;animation:fadeUp .4s cubic-bezier(.22,1,.36,1) both}

.auth-brand{text-align:center;margin-bottom:28px}
.auth-brand-name{font-size:2rem;font-weight:700;letter-spacing:-.04em;color:var(--tx1)}
.auth-brand-name span{color:var(--ac)}
.auth-brand-tag{font-size:.78rem;color:var(--tx3);margin-top:5px;font-weight:400}

.auth-box{
  background:var(--s1);border:1px solid var(--bd2);
  border-radius:20px;padding:28px;box-shadow:var(--sh);
}

.auth-tabs{
  display:flex;gap:3px;background:var(--s2);
  border-radius:11px;padding:4px;margin-bottom:22px;
}
.at{
  flex:1;padding:9px 12px;border:none;background:transparent;
  color:var(--tx3);font-size:.88rem;font-weight:600;
  cursor:pointer;border-radius:8px;transition:all .18s;
}
.at.on{background:var(--ac);color:var(--bg)}

.af{margin-bottom:14px}
.af label{display:block;font-size:.72rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--tx3);margin-bottom:6px}
.af input{
  width:100%;background:var(--s2);border:1px solid var(--bd2);
  border-radius:10px;padding:11px 14px;color:var(--tx1);
  font-size:.9rem;outline:none;transition:border-color .18s,box-shadow .18s;
}
.af input:focus{border-color:var(--ac);box-shadow:0 0 0 3px var(--ad)}
.af input::placeholder{color:var(--tx3)}

.auth-btn{
  width:100%;padding:12px;background:var(--ac);color:var(--bg);
  border:none;border-radius:10px;font-size:.92rem;font-weight:700;
  cursor:pointer;transition:opacity .15s,transform .15s;margin-top:6px;
}
.auth-btn:hover{opacity:.87;transform:translateY(-1px)}

.auth-err{font-size:.78rem;color:var(--ac3);text-align:center;margin-top:10px;min-height:16px}

.saved-wrap{margin-top:18px;padding-top:16px;border-top:1px solid var(--bd1)}
.saved-title{font-size:.7rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--tx3);margin-bottom:9px}
.u-chip{
  display:inline-flex;align-items:center;gap:5px;
  padding:5px 12px;background:var(--s2);border:1px solid var(--bd1);
  border-radius:100px;font-size:.8rem;cursor:pointer;margin:2px;
  color:var(--tx2);transition:all .15s;
}
.u-chip:hover{border-color:var(--ab);color:var(--ac);background:var(--ad)}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   APP LAYOUT  â€” 3-column grid desktop
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#app{
  display:grid;
  grid-template-columns:var(--sb-w) 1fr var(--ap-w);
  grid-template-rows:var(--header-h) 1fr;
  height:100vh;overflow:hidden;
  position:relative;z-index:1;
}

/* â”€â”€â”€ HEADER â”€â”€â”€ */
header{
  grid-column:1/-1;
  display:flex;align-items:center;justify-content:space-between;
  padding:0 18px;
  border-bottom:1px solid var(--bd1);
  background:var(--bg);
  z-index:100;position:relative;
  transition:background .3s;
  height:var(--header-h);
}

.h-left{display:flex;align-items:center;gap:10px}

/* Hamburger â€” mobile only */
.burger{
  display:none;flex-direction:column;justify-content:center;gap:5px;
  width:36px;height:36px;background:none;border:none;cursor:pointer;
  padding:6px;border-radius:8px;transition:background .15s;
}
.burger:hover{background:var(--s2)}
.burger span{display:block;width:18px;height:1.5px;background:var(--tx2);border-radius:2px;transition:all .2s}

.logo{
  font-size:1.15rem;font-weight:700;letter-spacing:-.025em;
  color:var(--tx1);display:flex;align-items:center;gap:8px;
  text-decoration:none;
}
.logo-dot{width:7px;height:7px;border-radius:50%;background:var(--ac);animation:blink 2.2s ease-in-out infinite;flex-shrink:0}
@keyframes blink{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.3;transform:scale(.65)}}
.logo span{color:var(--ac)}

/* Desktop center nav */
.h-nav{
  display:flex;gap:2px;
  background:var(--s2);border:1px solid var(--bd1);
  border-radius:100px;padding:3px;
}
.hn{
  padding:6px 15px;border:none;border-radius:100px;background:transparent;
  color:var(--tx3);font-size:.82rem;font-weight:500;cursor:pointer;
  transition:all .15s;
}
.hn:hover{background:var(--s3);color:var(--tx1)}
.hn.on{background:var(--s3);color:var(--ac);font-weight:600}

.h-right{display:flex;align-items:center;gap:8px}

.h-badge{
  font-size:.78rem;color:var(--tx3);padding:5px 12px;
  background:var(--s2);border:1px solid var(--bd1);border-radius:100px;
}
.h-badge strong{color:var(--ac);font-weight:600}

/* Theme button (header, desktop only) */
.th-wrap{position:relative}
.th-btn{
  display:flex;align-items:center;gap:6px;padding:6px 12px;
  background:var(--s2);border:1px solid var(--bd1);border-radius:100px;
  color:var(--tx2);font-size:.8rem;font-weight:500;cursor:pointer;
  transition:all .15s;
}
.th-btn:hover{border-color:var(--bd2);color:var(--tx1)}
.th-drop{
  position:absolute;top:calc(100% + 8px);right:0;
  background:var(--s1);border:1px solid var(--bd2);
  border-radius:16px;padding:14px;width:218px;
  box-shadow:var(--sh);z-index:200;
  display:none;animation:fadeDown .18s cubic-bezier(.22,1,.36,1);
}
.th-drop.on{display:block}
@keyframes fadeDown{from{opacity:0;transform:translateY(-7px) scale(.96)}to{opacity:1;transform:translateY(0) scale(1)}}
.td-head{font-size:.7rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--tx3);margin-bottom:10px}
.td-grid{display:grid;grid-template-columns:1fr 1fr;gap:5px}
.td-opt{
  display:flex;flex-direction:column;align-items:center;gap:6px;
  padding:9px 5px;border-radius:9px;border:1px solid var(--bd1);
  background:var(--s2);cursor:pointer;transition:all .15s;
  font-size:.75rem;font-weight:500;color:var(--tx2);
}
.td-opt:hover{border-color:var(--bd2);color:var(--tx1)}
.td-opt.on{border-color:var(--ac);color:var(--ac);background:var(--ad)}
.td-sw{width:30px;height:17px;border-radius:5px;border:1px solid rgba(128,128,128,.2)}

/* Mobile account avatar button */
.mob-acc-btn{
  display:none;align-items:center;gap:7px;padding:5px 11px 5px 5px;
  background:var(--s2);border:1px solid var(--bd1);border-radius:100px;
  cursor:pointer;transition:all .15s;font-size:.82rem;color:var(--tx2);
}
.mob-acc-btn:hover{border-color:var(--bd2);color:var(--tx1)}
.u-av{
  width:27px;height:27px;border-radius:50%;
  background:linear-gradient(135deg,var(--ac),var(--ac2));
  display:flex;align-items:center;justify-content:center;
  font-size:.75rem;font-weight:700;color:var(--bg);flex-shrink:0;
}

/* â”€â”€â”€ LEFT SIDEBAR â”€â”€â”€ */
.sidebar{
  grid-row:2;
  border-right:1px solid var(--bd1);
  background:var(--s1);
  overflow-y:auto;overflow-x:hidden;
  display:flex;flex-direction:column;
  transition:background .3s;
  /* Mobile: becomes a fixed drawer */
}

.sb-scroll{padding:14px 8px;flex:1}
.sb-sec{margin-bottom:22px}
.sb-lbl{font-size:.68rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--tx3);margin-bottom:5px;padding:0 10px}

.nav-item{
  display:flex;align-items:center;gap:10px;width:100%;
  padding:10px 12px;border-radius:9px;border:none;background:transparent;
  color:var(--tx2);font-size:.88rem;font-weight:500;
  cursor:pointer;text-align:left;transition:all .15s;
}
.nav-item .ic{font-size:.95rem;flex-shrink:0}
.nav-item:hover{background:var(--s2);color:var(--tx1)}
.nav-item.on{background:var(--ad);color:var(--ac);font-weight:600}

.sb-stat{
  display:flex;justify-content:space-between;align-items:center;
  padding:5px 12px;font-size:.82rem;color:var(--tx3);
}
.sb-stat .sv{font-size:1.4rem;font-weight:700;letter-spacing:-.03em;color:var(--tx2)}
.sb-stat .sv.g{color:var(--ac)}
.sb-stat .sv.r{color:var(--ac3)}

/* â”€â”€â”€ MAIN â”€â”€â”€ */
.main{
  grid-row:2;overflow-y:auto;padding:22px 24px;
  display:flex;flex-direction:column;gap:18px;
  background:var(--bg);
}

.page{display:none;flex-direction:column;gap:18px}
.page.on{display:flex;animation:fadeUp .22s ease}

@keyframes fadeUp{from{opacity:0;transform:translateY(7px)}to{opacity:1;transform:translateY(0)}}

.pg-title{
  font-size:1.6rem;font-weight:700;letter-spacing:-.035em;
  color:var(--tx1);display:flex;align-items:baseline;gap:12px;
}
.pg-title em{color:var(--ac);font-style:normal}
.pg-cnt{font-size:.78rem;font-weight:500;color:var(--tx3)}

/* â”€â”€â”€ RIGHT: ACCOUNT PANEL â”€â”€â”€ */
.account-col{
  grid-row:2;
  border-left:1px solid var(--bd1);
  background:var(--s1);
  overflow-y:auto;
  display:flex;flex-direction:column;
  transition:background .3s;
}

.ap-sec{padding:18px 16px;border-bottom:1px solid var(--bd1)}
.ap-sec:last-child{border-bottom:none}

.ap-head{
  font-size:.68rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;
  color:var(--tx3);margin-bottom:12px;
  display:flex;align-items:center;gap:8px;
}
.ap-head::after{content:'';flex:1;height:1px;background:var(--bd1)}

/* Profile card */
.profile-card{
  display:flex;align-items:center;gap:12px;
  padding:13px 14px;
  background:var(--s2);border:1px solid var(--bd2);border-radius:14px;
  margin-bottom:12px;
}
.profile-av{
  width:42px;height:42px;border-radius:50%;flex-shrink:0;
  background:linear-gradient(135deg,var(--ac),var(--ac2));
  display:flex;align-items:center;justify-content:center;
  font-size:1.1rem;font-weight:700;color:var(--bg);
}
.profile-info{flex:1;min-width:0}
.profile-name{font-size:.95rem;font-weight:600;color:var(--tx1);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.profile-role{font-size:.75rem;color:var(--tx3);margin-top:1px}
.profile-badge{
  display:inline-flex;align-items:center;gap:4px;
  padding:3px 9px;border-radius:100px;
  background:var(--ad);border:1px solid var(--ab);
  font-size:.7rem;font-weight:600;color:var(--ac);flex-shrink:0;
}

/* Quick stats 2x2 */
.q-stats{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:4px}
.qs-card{
  background:var(--s2);border:1px solid var(--bd1);
  border-radius:11px;padding:11px 13px;
}
.qs-val{font-size:1.4rem;font-weight:700;letter-spacing:-.035em;color:var(--tx1);line-height:1}
.qs-val.a{color:var(--ac)}.qs-val.b{color:var(--ac2)}.qs-val.c{color:var(--ac3)}
.qs-lbl{font-size:.7rem;color:var(--tx3);margin-top:3px;font-weight:500}

/* AI trigger row */
.ai-trigger{
  display:flex;align-items:center;gap:11px;
  padding:12px 14px;background:var(--ad);border:1px solid var(--ab);
  border-radius:13px;cursor:pointer;transition:all .18s;
}
.ai-trigger:hover{background:var(--ac)}
.ai-trigger:hover .ait-name{color:var(--bg)}
.ai-trigger:hover .ait-sub{color:rgba(0,0,0,.55)}
.ai-trigger:hover .ait-ic{background:rgba(0,0,0,.15);border-color:transparent}

.ait-ic{
  width:36px;height:36px;border-radius:10px;
  background:var(--s2);border:1px solid var(--bd2);
  display:flex;align-items:center;justify-content:center;
  font-size:1.1rem;flex-shrink:0;transition:all .18s;
}
.ait-body{flex:1;min-width:0}
.ait-name{font-size:.9rem;font-weight:600;color:var(--ac);display:block;transition:color .18s}
.ait-sub{font-size:.75rem;color:var(--tx3);transition:color .18s}
.ait-arr{font-size:.85rem;color:var(--tx3);flex-shrink:0;transition:all .18s}

/* Theme grid in account panel */
.ap-theme-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:6px}
.ap-th-opt{
  display:flex;flex-direction:column;align-items:center;gap:6px;
  padding:10px 5px;border-radius:9px;border:1px solid var(--bd1);
  background:var(--s2);cursor:pointer;transition:all .15s;
  font-size:.74rem;font-weight:500;color:var(--tx2);
}
.ap-th-opt:hover{border-color:var(--bd2);color:var(--tx1)}
.ap-th-opt.on{border-color:var(--ac);color:var(--ac);background:var(--ad)}
.ap-sw{width:30px;height:17px;border-radius:5px;border:1px solid rgba(128,128,128,.15)}

/* Account action buttons */
.ap-btn{
  display:flex;align-items:center;gap:10px;width:100%;
  padding:11px 13px;background:transparent;
  border:1px solid var(--bd1);border-radius:11px;
  cursor:pointer;font-size:.88rem;font-weight:500;
  color:var(--tx2);text-align:left;margin-bottom:6px;
  transition:all .15s;
}
.ap-btn:last-child{margin-bottom:0}
.ap-btn:hover{background:var(--s2);color:var(--tx1);border-color:var(--bd2)}
.ap-btn.danger{color:var(--ac3)}
.ap-btn.danger:hover{background:var(--ad);border-color:var(--ac3)}
.ap-btn-ic{width:30px;height:30px;border-radius:8px;background:var(--s3);display:flex;align-items:center;justify-content:center;font-size:.9rem;flex-shrink:0}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   DASHBOARD
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.hero{
  background:var(--s1);border:1px solid var(--bd1);
  border-radius:16px;padding:24px 26px;
  position:relative;overflow:hidden;
}
.hero::after{
  content:'';position:absolute;top:-40px;right:-40px;
  width:220px;height:220px;border-radius:50%;
  background:radial-gradient(circle,var(--ad),transparent 70%);
  pointer-events:none;
}
.hero-tag{
  font-size:.7rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;
  color:var(--ac);margin-bottom:8px;
  display:flex;align-items:center;gap:7px;
}
.hero-tag::before{content:'';width:14px;height:1.5px;background:var(--ac);border-radius:2px}
.hero-greet{font-size:1.55rem;font-weight:700;letter-spacing:-.025em;line-height:1.2;color:var(--tx1);margin-bottom:6px}
.hero-greet em{color:var(--ac);font-style:normal}
.hero-sub{font-size:.88rem;color:var(--tx2);line-height:1.6;margin-bottom:16px;max-width:400px}

.prog-row{display:flex;align-items:center;gap:12px;margin-bottom:16px}
.prog-track{flex:1;max-width:180px;height:3px;background:var(--s3);border-radius:2px;overflow:hidden}
.prog-fill{height:100%;background:var(--ac);border-radius:2px;transition:width .9s cubic-bezier(.22,1,.36,1)}
.prog-lbl{font-size:.78rem;color:var(--tx3)}
.prog-pct{font-size:.78rem;font-weight:700;color:var(--ac)}

.hero-cta{display:flex;gap:8px;flex-wrap:wrap}
.cta{
  display:inline-flex;align-items:center;gap:7px;
  padding:10px 20px;border-radius:10px;border:none;
  font-size:.88rem;font-weight:600;cursor:pointer;transition:all .18s;
}
.cta-p{background:var(--ac);color:var(--bg)}
.cta-p:hover{opacity:.86;transform:translateY(-1px)}
.cta-s{background:var(--s2);color:var(--tx2);border:1px solid var(--bd2)}
.cta-s:hover{color:var(--tx1);border-color:var(--ac)}

/* Stats */
.stats-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(132px,1fr));gap:10px}
.sc{
  background:var(--s1);border:1px solid var(--bd1);
  border-radius:13px;padding:15px 17px;
  display:flex;flex-direction:column;gap:4px;
  transition:border-color .18s,transform .18s;
  animation:fadeUp .3s ease both;
}
.sc:hover{border-color:var(--bd2);transform:translateY(-2px)}
.sc:nth-child(1){animation-delay:.04s}.sc:nth-child(2){animation-delay:.08s}.sc:nth-child(3){animation-delay:.12s}.sc:nth-child(4){animation-delay:.16s}.sc:nth-child(5){animation-delay:.20s}.sc:nth-child(6){animation-delay:.24s}
.sc-lbl{font-size:.7rem;font-weight:600;letter-spacing:.06em;text-transform:uppercase;color:var(--tx3)}
.sc-val{font-size:2.2rem;font-weight:700;letter-spacing:-.04em;line-height:1;color:var(--tx1)}
.sc-val.a{color:var(--ac)}.sc-val.b{color:var(--ac2)}.sc-val.c{color:var(--ac3)}
.sc-sub{font-size:.75rem;color:var(--tx3)}

/* Panel row */
.panels-row{display:grid;grid-template-columns:1.1fr .9fr;gap:11px}
.panel{background:var(--s1);border:1px solid var(--bd1);border-radius:14px;padding:18px 20px;transition:background .3s}
.panel-lbl{font-size:.7rem;font-weight:700;letter-spacing:.09em;text-transform:uppercase;color:var(--tx3);margin-bottom:14px;display:flex;align-items:center;gap:8px}
.panel-lbl::after{content:'';flex:1;height:1px;background:var(--bd1)}
.chart-box{position:relative;height:155px}

.streak-row{display:flex;gap:5px;flex-wrap:wrap}
.sd{width:29px;height:29px;border-radius:7px;background:var(--s2);border:1px solid var(--bd1);display:flex;align-items:center;justify-content:center;font-size:.62rem;font-weight:700;color:var(--tx3);transition:all .18s}
.sd.on{background:var(--ad);border-color:var(--ab);color:var(--ac)}
.sd.td{background:var(--ac);border-color:var(--ac);color:var(--bg)}
.streak-note{font-size:.78rem;color:var(--tx3);margin-top:12px}

.rec-row{display:flex;align-items:center;gap:10px;padding:9px 0;border-bottom:1px solid var(--bd1);font-size:.85rem}
.rec-row:last-child{border-bottom:none}
.rec-name{flex:1;color:var(--tx2);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   TOOLBAR + TASKS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.toolbar{
  display:flex;align-items:center;gap:7px;flex-wrap:wrap;
  background:var(--s1);border:1px solid var(--bd1);
  border-radius:13px;padding:10px 13px;
}
.div-line{width:1px;height:19px;background:var(--bd1);flex-shrink:0}

.chip{
  padding:6px 14px;border-radius:100px;border:1px solid var(--bd1);
  background:transparent;color:var(--tx3);
  font-size:.8rem;font-weight:500;cursor:pointer;transition:all .15s;
}
.chip:hover{border-color:var(--bd2);color:var(--tx2)}
.chip.on{background:var(--ac);color:var(--bg);border-color:var(--ac);font-weight:600}

.srch{
  flex:1;min-width:130px;max-width:240px;
  padding:8px 14px;border-radius:100px;border:1px solid var(--bd1);
  background:var(--s2);color:var(--tx1);
  font-size:.85rem;outline:none;transition:all .18s;
}
.srch:focus{border-color:var(--ac);box-shadow:0 0 0 3px var(--ad)}
.srch::placeholder{color:var(--tx3)}

/* Task grid + cards */
.task-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(266px,1fr));gap:10px}

.tc{
  background:var(--s1);border:1px solid var(--bd1);
  border-radius:14px;padding:16px 18px;
  transition:border-color .18s,transform .18s,box-shadow .18s;
  position:relative;overflow:hidden;animation:fadeUp .25s ease both;
}
.tc::before{content:'';position:absolute;top:0;left:0;right:0;height:2.5px;background:var(--bd1);transition:background .2s}
.tc.p-high::before{background:var(--ac3)}
.tc.p-medium::before{background:var(--ac2);opacity:.75}
.tc:hover{border-color:var(--bd2);transform:translateY(-2px);box-shadow:var(--cs)}
.tc.done-c{opacity:.56}

.tc-top{display:flex;justify-content:space-between;align-items:flex-start;gap:8px;margin-bottom:6px}
.tc-title{font-size:.95rem;font-weight:600;line-height:1.4;flex:1;color:var(--tx1)}
.tc.done-c .tc-title{text-decoration:line-through;color:var(--tx3);font-weight:400}

.tc-acts{display:flex;gap:3px;opacity:0;transition:opacity .18s;flex-shrink:0}
.tc:hover .tc-acts{opacity:1}
@media(hover:none){.tc-acts{opacity:1!important}}

.ib{
  width:27px;height:27px;border-radius:7px;border:1px solid var(--bd1);
  background:var(--s2);color:var(--tx3);font-size:.72rem;
  cursor:pointer;display:flex;align-items:center;justify-content:center;
  transition:all .15s;
}
.ib:hover{background:var(--s3);color:var(--tx1);border-color:var(--bd2)}
.ib.del:hover{background:var(--ad);color:var(--ac3);border-color:var(--ac3)}
.ib.ai:hover{background:var(--ad);color:var(--ac);border-color:var(--ab)}

.tc-desc{font-size:.8rem;color:var(--tx3);margin-top:5px;line-height:1.6;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.tc-meta{display:flex;gap:5px;flex-wrap:wrap;margin-top:10px}

.badge{padding:3px 9px;border-radius:100px;font-size:.72rem;font-weight:600;border:1px solid}
.b-sub{background:var(--ad);color:var(--ac);border-color:var(--ab)}
.b-hi{color:var(--ac3);border-color:var(--ac3);background:transparent}
.b-me{color:var(--ac2);border-color:var(--ac2);background:transparent}
.b-lo,.b-pe{color:var(--tx3);border-color:var(--bd2);background:transparent}
.b-ip{color:var(--ac2);border-color:var(--ac2);background:transparent}
.b-co{color:var(--tx3);border-color:var(--bd1);background:transparent}

.tc-due{font-size:.78rem;color:var(--tx3);margin-top:7px;display:flex;align-items:center;gap:5px}
.tc-due.od{color:var(--ac3);font-weight:500}

.sub-list{margin-top:10px;padding-top:10px;border-top:1px solid var(--bd1);display:flex;flex-direction:column;gap:5px}
.sub-item{display:flex;align-items:center;gap:8px;font-size:.8rem;color:var(--tx3);cursor:pointer;padding:2px 0;transition:color .15s}
.sub-item:hover{color:var(--tx2)}
.sub-ck{width:14px;height:14px;border-radius:4px;border:1px solid var(--bd2);flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:.55rem;transition:all .15s}
.sub-item.done .sub-ck{background:var(--ac);border-color:var(--ac);color:var(--bg)}
.sub-item.done span{text-decoration:line-through;opacity:.42}

.empty-st{grid-column:1/-1;text-align:center;padding:56px 20px;color:var(--tx3)}
.empty-ico{font-size:2.8rem;display:block;margin-bottom:12px;opacity:.35}
.empty-txt{font-size:1rem;color:var(--tx3)}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   FORMS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.form-card{background:var(--s1);border:1px solid var(--bd1);border-radius:16px;padding:24px;display:flex;flex-direction:column;gap:14px}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.fg{display:flex;flex-direction:column;gap:6px}
.fg.full{grid-column:1/-1}
.fg label{font-size:.72rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--tx3)}
.fg input,.fg textarea,.fg select{
  background:var(--s2);border:1px solid var(--bd2);
  border-radius:10px;padding:11px 14px;color:var(--tx1);
  font-size:.9rem;outline:none;transition:all .18s;width:100%;
}
.fg input:focus,.fg textarea:focus,.fg select:focus{border-color:var(--ac);box-shadow:0 0 0 3px var(--ad);background:var(--s3)}
.fg input::placeholder,.fg textarea::placeholder{color:var(--tx3)}
.fg textarea{resize:vertical;min-height:80px}
.fg select option{background:var(--s2)}
.form-acts{display:flex;gap:8px;justify-content:flex-end;flex-wrap:wrap;padding-top:4px}

.btn{
  padding:10px 19px;border-radius:10px;border:none;
  font-size:.88rem;font-weight:600;cursor:pointer;transition:all .18s;
  display:inline-flex;align-items:center;gap:6px;
}
.btn-p{background:var(--ac);color:var(--bg)}
.btn-p:hover{opacity:.85;transform:translateY(-1px)}
.btn-s{background:var(--s2);color:var(--tx2);border:1px solid var(--bd2)}
.btn-s:hover{border-color:var(--ac);color:var(--ac)}
.btn-ai{background:var(--ad);color:var(--ac);border:1px solid var(--ab)}
.btn-ai:hover{background:var(--ac);color:var(--bg)}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   TIMELINE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.timeline{display:flex;flex-direction:column;gap:9px}
.tl{
  display:flex;gap:14px;align-items:flex-start;
  padding:14px 18px;background:var(--s1);border:1px solid var(--bd1);
  border-radius:13px;animation:fadeUp .25s ease both;transition:border-color .18s,transform .18s;
}
.tl:hover{border-color:var(--bd2);transform:translateX(3px)}
.tl-date{text-align:center;min-width:42px;flex-shrink:0;padding:7px 8px;background:var(--ad);border:1px solid var(--ab);border-radius:10px}
.tl-day{font-size:1.5rem;font-weight:700;letter-spacing:-.03em;line-height:1;color:var(--ac)}
.tl-mon{font-size:.62rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:var(--ac);opacity:.75}
.tl-body{flex:1;min-width:0}
.tl-title{font-size:.95rem;font-weight:600;color:var(--tx1);margin-bottom:7px}
.tl-acts{display:flex;gap:5px;flex-shrink:0}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   AI CHAT PANEL  (slides over from right)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.ai-panel{
  position:fixed;top:0;right:-100%;
  width:min(350px,100vw);height:100%;z-index:200;
  background:var(--s1);border-left:1px solid var(--bd2);
  display:flex;flex-direction:column;overflow:hidden;
  transition:right .3s cubic-bezier(.22,1,.36,1);
  box-shadow:-12px 0 40px rgba(0,0,0,.4);
}
.ai-panel.on{right:0}

.ai-hdr{padding:14px 16px;border-bottom:1px solid var(--bd1);display:flex;align-items:center;gap:10px;background:var(--s1)}
.ai-av{width:34px;height:34px;border-radius:10px;background:var(--ad);border:1px solid var(--ab);display:flex;align-items:center;justify-content:center;font-size:1.1rem;flex-shrink:0}
.ai-title{font-size:.95rem;font-weight:600;color:var(--tx1)}
.ai-st{font-size:.72rem;color:var(--ac);display:flex;align-items:center;gap:4px;margin-top:1px}
.ai-close{margin-left:auto;background:none;border:none;color:var(--tx3);font-size:1rem;cursor:pointer;padding:5px 9px;border-radius:7px;transition:all .15s}
.ai-close:hover{background:var(--s2);color:var(--ac3)}

.ai-msgs{flex:1;overflow-y:auto;padding:14px;display:flex;flex-direction:column;gap:10px;scroll-behavior:smooth}
.msg{display:flex;gap:8px;animation:fadeUp .18s ease both}
.msg.usr{flex-direction:row-reverse}
.msg-bub{max-width:87%;padding:10px 13px;border-radius:13px;font-size:.86rem;line-height:1.6}
.msg.ai .msg-bub{background:var(--s2);border:1px solid var(--bd1);border-bottom-left-radius:3px;color:var(--tx2)}
.msg.usr .msg-bub{background:var(--ad);border:1px solid var(--ab);border-bottom-right-radius:3px;color:var(--tx1)}
.msg-av{width:24px;height:24px;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:.75rem;flex-shrink:0;align-self:flex-end}
.msg.ai .msg-av{background:var(--ad);border:1px solid var(--ab)}
.msg.usr .msg-av{background:var(--s2);border:1px solid var(--bd1)}

.qp-row{padding:10px 13px;display:flex;gap:5px;flex-wrap:wrap;border-top:1px solid var(--bd1)}
.qbtn{padding:5px 11px;border-radius:100px;border:1px solid var(--bd1);background:transparent;color:var(--tx3);font-size:.76rem;font-weight:500;cursor:pointer;transition:all .15s;white-space:nowrap}
.qbtn:hover{border-color:var(--ab);color:var(--ac);background:var(--ad)}

.ai-inp-row{padding:10px 13px;display:flex;gap:7px;border-top:1px solid var(--bd1)}
.ai-inp{flex:1;background:var(--s2);border:1px solid var(--bd1);border-radius:100px;padding:9px 14px;color:var(--tx1);font-size:.86rem;outline:none;transition:all .18s}
.ai-inp:focus{border-color:var(--ac);box-shadow:0 0 0 3px var(--ad)}
.send-b{width:35px;height:35px;border-radius:50%;border:none;background:var(--ac);color:var(--bg);font-size:.82rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .18s;flex-shrink:0}
.send-b:hover{opacity:.82;transform:scale(1.07)}
.send-b:disabled{background:var(--s2);color:var(--tx3);cursor:default;transform:none;opacity:1}

.typing{display:flex;gap:4px;padding:7px 11px;align-items:center}
.tdot{width:5px;height:5px;border-radius:50%;background:var(--tx3);animation:td 1.2s ease-in-out infinite}
.tdot:nth-child(2){animation-delay:.15s}.tdot:nth-child(3){animation-delay:.3s}
@keyframes td{0%,80%,100%{opacity:.3;transform:scale(.7)}40%{opacity:1;transform:scale(1.1)}}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   MODAL
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.modal-bg{
  position:fixed;inset:0;background:rgba(0,0,0,.62);
  backdrop-filter:blur(6px);z-index:300;
  display:none;align-items:center;justify-content:center;padding:16px;
}
.modal-bg.on{display:flex}
.modal-box{
  background:var(--s1);border:1px solid var(--bd2);
  border-radius:18px;padding:24px;width:100%;max-width:500px;
  box-shadow:var(--sh);animation:fadeUp .22s cubic-bezier(.22,1,.36,1);
  max-height:90vh;overflow-y:auto;
}
.modal-title{font-size:1.25rem;font-weight:700;letter-spacing:-.025em;margin-bottom:18px;color:var(--tx1)}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   TOASTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.toast-wrap{position:fixed;bottom:18px;right:18px;z-index:600;display:flex;flex-direction:column;gap:6px}
.toast{
  padding:10px 16px;border-radius:11px;border:1px solid var(--bd2);
  background:var(--s2);font-size:.82rem;font-weight:500;
  display:flex;align-items:center;gap:8px;
  animation:toastIn .25s cubic-bezier(.22,1,.36,1) both;
  max-width:268px;box-shadow:var(--sh);
}
@keyframes toastIn{from{opacity:0;transform:translateX(14px) scale(.94)}to{opacity:1;transform:translateX(0) scale(1)}}
.toast.ok{border-color:var(--ab);color:var(--ac)}
.toast.er{border-color:var(--ac3);color:var(--ac3)}
.toast.nf{border-color:var(--ac2);color:var(--ac2)}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   MOBILE DRAWERS â€” sidebar + account panel
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

/* Shared overlay */
.overlay{
  display:none;position:fixed;inset:0;
  background:rgba(0,0,0,.52);backdrop-filter:blur(3px);
  z-index:150;
}
.overlay.on{display:block}

/* Mobile account drawer (slides from right) */
.mob-acc-drawer{
  position:fixed;top:0;right:-100%;
  width:min(290px,90vw);height:100%;
  z-index:160;background:var(--s1);
  border-left:1px solid var(--bd2);
  overflow-y:auto;
  transition:right .3s cubic-bezier(.22,1,.36,1);
  box-shadow:-10px 0 36px rgba(0,0,0,.45);
  display:flex;flex-direction:column;
}
.mob-acc-drawer.on{right:0}

.mad-top{
  display:flex;align-items:center;justify-content:space-between;
  padding:16px 16px 14px;border-bottom:1px solid var(--bd1);
  position:sticky;top:0;background:var(--s1);z-index:2;
}
.mad-title{font-size:1rem;font-weight:700;letter-spacing:-.02em;color:var(--tx1)}
.mad-close{background:none;border:none;color:var(--tx3);font-size:1.1rem;cursor:pointer;width:30px;height:30px;border-radius:7px;display:flex;align-items:center;justify-content:center;transition:all .15s}
.mad-close:hover{background:var(--s2);color:var(--ac3)}
.mad-body{padding:14px;flex:1}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   BOTTOM NAV (mobile)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.bot-nav{
  display:none;
  position:fixed;bottom:0;left:0;right:0;
  background:var(--s1);border-top:1px solid var(--bd1);
  z-index:140;
  padding:8px 0 calc(8px + env(safe-area-inset-bottom));
  justify-content:space-around;align-items:center;
}
.bnb{
  display:flex;flex-direction:column;align-items:center;gap:3px;
  background:none;border:none;color:var(--tx3);
  font-size:.62rem;font-weight:600;cursor:pointer;
  padding:5px 10px;border-radius:9px;min-width:52px;
  transition:all .15s;text-transform:uppercase;letter-spacing:.05em;
}
.bnb .bni{font-size:1.2rem}
.bnb.on{color:var(--ac)}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SCROLLBAR
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
::-webkit-scrollbar{width:3px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--bd2);border-radius:2px}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   RESPONSIVE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

/* Tablet: hide account col, AI opens as drawer */
@media(max-width:1100px){
  #app{grid-template-columns:var(--sb-w) 1fr}
  .account-col{display:none}
  .mob-acc-btn{display:flex}
  .h-badge{display:none}
  .h-nav{display:none}
  .panels-row{grid-template-columns:1fr}
  .th-wrap{display:none}/* use account drawer for themes */
}

/* Mobile: full single column */
@media(max-width:767px){
  #app{grid-template-columns:1fr;grid-template-rows:var(--header-h) 1fr}

  /* Sidebar becomes left-slide drawer */
  .sidebar{
    position:fixed !important;
    top:0;left:-100%;
    width:min(260px,82vw);
    height:100%;
    z-index:160;
    /* reset grid row */
    grid-row:unset;
    transition:left .3s cubic-bezier(.22,1,.36,1);
    box-shadow:8px 0 32px rgba(0,0,0,.45);
  }
  .sidebar.on{left:0}
  .sb-scroll{padding-top:72px}/* room for sticky header */

  .burger{display:flex}
  .h-nav{display:none}
  .h-badge{display:none}
  .th-wrap{display:none}
  header{padding:0 14px}

  .main{
    grid-row:2;
    padding:16px 14px calc(16px + var(--nav-h));
  }

  .bot-nav{display:flex}

  .task-grid{grid-template-columns:1fr}
  .form-row{grid-template-columns:1fr}
  .pg-title{font-size:1.4rem}
  .modal-box{padding:20px}
  .form-acts{flex-direction:column}
  .form-acts .btn{justify-content:center}
  .toast-wrap{bottom:calc(var(--nav-h) + 10px);right:10px;left:10px}
  .toast{max-width:100%}
  .stats-grid{grid-template-columns:1fr 1fr}
  .panels-row{grid-template-columns:1fr}
  .hero{padding:18px 18px}
}

@media(min-width:1440px){
  #app{grid-template-columns:240px 1fr 270px}
  .task-grid{grid-template-columns:repeat(auto-fill,minmax(278px,1fr))}
}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  AUTH SCREEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="authScreen">
  <div class="aw">
    <div class="auth-brand">
      <div class="auth-brand-name">Study<span>Bot</span></div>
      <div class="auth-brand-tag">Your AI-powered study assistant</div>
    </div>

    <div class="auth-box">
      <div class="auth-tabs">
        <button class="at on" id="aTab1" onclick="switchTab('login')">Sign In</button>
        <button class="at" id="aTab2" onclick="switchTab('register')">Register</button>
      </div>

      <!-- LOGIN -->
      <div id="loginForm">
        <div class="af"><label>Username</label><input type="text" id="lU" placeholder="Your username" autocomplete="username"></div>
        <div class="af"><label>Password</label><input type="password" id="lP" placeholder="Your password" autocomplete="current-password" onkeydown="if(event.key==='Enter')doLogin()"></div>
        <button class="auth-btn" onclick="doLogin()">Sign In â†’</button>
        <div class="auth-err" id="lE"></div>
        <div class="saved-wrap" id="savedWrap" style="display:none">
          <div class="saved-title">Saved accounts</div>
          <div id="savedList"></div>
        </div>
      </div>

      <!-- REGISTER -->
      <div id="regForm" style="display:none">
        <div class="af"><label>Username</label><input type="text" id="rU" placeholder="Choose username" autocomplete="username"></div>
        <div class="af"><label>Password</label><input type="password" id="rP" placeholder="At least 4 characters" autocomplete="new-password"></div>
        <div class="af"><label>Confirm Password</label><input type="password" id="rP2" placeholder="Repeat password" autocomplete="new-password" onkeydown="if(event.key==='Enter')doReg()"></div>
        <button class="auth-btn" onclick="doReg()">Create Account â†’</button>
        <div class="auth-err" id="rE"></div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  APP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="app" style="display:none">

  <!-- HEADER -->
  <header>
    <div class="h-left">
      <button class="burger" onclick="toggleSB()" aria-label="Menu">
        <span></span><span></span><span></span>
      </button>
      <div class="logo">
        <div class="logo-dot"></div>
        Study<span>Bot</span>
      </div>
    </div>

    <div class="h-nav">
      <button class="hn on" id="hn-d" onclick="goPage('dashboard');setHN('hn-d')">Dashboard</button>
      <button class="hn" id="hn-t"    onclick="goPage('tasks');setHN('hn-t')">Tasks</button>
      <button class="hn" id="hn-u"    onclick="goPage('upcoming');setHN('hn-u')">Upcoming</button>
      <button class="hn" id="hn-a"    onclick="goPage('add');setHN('hn-a')">+ New Task</button>
    </div>

    <div class="h-right">
      <div class="h-badge" id="hBadge">â€”</div>

      <!-- Theme (desktop) -->
      <div class="th-wrap">
        <button class="th-btn" onclick="toggleThDrop()">ğŸ¨ Theme</button>
        <div class="th-drop" id="thDrop">
          <div class="td-head">Choose Theme</div>
          <div class="td-grid">
            <div class="td-opt on" id="do-ink"   onclick="setTheme('ink')">  <div class="td-sw" style="background:linear-gradient(135deg,#0d0d12 50%,#b6f040)"></div>Ink</div>
            <div class="td-opt"    id="do-paper"  onclick="setTheme('paper')"><div class="td-sw" style="background:linear-gradient(135deg,#f3ede1 50%,#c03b12)"></div>Paper</div>
            <div class="td-opt"    id="do-slate"  onclick="setTheme('slate')"><div class="td-sw" style="background:linear-gradient(135deg,#0c1018 50%,#4ea4ff)"></div>Slate</div>
            <div class="td-opt"    id="do-rose"   onclick="setTheme('rose')"> <div class="td-sw" style="background:linear-gradient(135deg,#110909 50%,#ff5f7e)"></div>Rose</div>
            <div class="td-opt"    id="do-mint"   onclick="setTheme('mint')"> <div class="td-sw" style="background:linear-gradient(135deg,#ecf4ef 50%,#077a50)"></div>Mint</div>
            <div class="td-opt"    id="do-dusk"   onclick="setTheme('dusk')"> <div class="td-sw" style="background:linear-gradient(135deg,#0a080f 50%,#bf84ff)"></div>Dusk</div>
          </div>
        </div>
      </div>

      <!-- Mobile account button -->
      <button class="mob-acc-btn" onclick="openAccDrawer()" id="mobAccBtn">
        <div class="u-av" id="hAva">?</div>
        <span id="hName">â€”</span>
      </button>
    </div>
  </header>

  <!-- LEFT SIDEBAR -->
  <aside class="sidebar" id="sidebar">
    <div class="sb-scroll">
      <div class="sb-sec">
        <div class="sb-lbl">Pages</div>
        <button class="nav-item on" data-p="dashboard" onclick="goPage('dashboard',this)"><span class="ic">ğŸ“Š</span>Dashboard</button>
        <button class="nav-item" data-p="tasks"     onclick="goPage('tasks',this)">    <span class="ic">ğŸ“‹</span>All Tasks</button>
        <button class="nav-item" data-p="upcoming"  onclick="goPage('upcoming',this)"> <span class="ic">ğŸ“…</span>Upcoming</button>
        <button class="nav-item" data-p="add"       onclick="goPage('add',this)">      <span class="ic">âœï¸</span>Add Task</button>
      </div>
      <div class="sb-sec">
        <div class="sb-lbl">Overview</div>
        <div class="sb-stat"><span>Pending</span>    <span class="sv" id="sPend">â€”</span></div>
        <div class="sb-stat"><span>In Progress</span><span class="sv" id="sInP">â€”</span></div>
        <div class="sb-stat"><span>Done</span>       <span class="sv g" id="sDone">â€”</span></div>
        <div class="sb-stat"><span>Overdue</span>    <span class="sv r" id="sOvd">â€”</span></div>
      </div>
      <div class="sb-sec">
        <div class="sb-lbl">Filter</div>
        <button class="nav-item" onclick="filterSt('pending');closeSB()">      <span class="ic">ğŸŸ¡</span>Pending</button>
        <button class="nav-item" onclick="filterSt('in-progress');closeSB()">  <span class="ic">ğŸ”µ</span>In Progress</button>
        <button class="nav-item" onclick="filterSt('completed');closeSB()">    <span class="ic">âœ…</span>Completed</button>
        <button class="nav-item" onclick="filterSt(null);closeSB()">           <span class="ic">âœ•</span>Clear Filter</button>
      </div>
    </div>
  </aside>

  <!-- MAIN CONTENT -->
  <main class="main">

    <!-- DASHBOARD -->
    <div class="page on" id="page-dashboard">
      <div class="hero">
        <div class="hero-tag" id="todayTag">LOADINGâ€¦</div>
        <div class="hero-greet">Good <em id="timeGreet">day</em>, <em id="greetName">Student</em>.</div>
        <div class="hero-sub" id="dashMot">Loading your overviewâ€¦</div>
        <div class="prog-row" id="progRow" style="display:none">
          <div class="prog-track"><div class="prog-fill" id="progFill" style="width:0%"></div></div>
          <span class="prog-lbl">Completion</span>
          <span class="prog-pct" id="progPct">0%</span>
        </div>
        <div class="hero-cta">
          <button class="cta cta-p" onclick="goPage('add');setHN('hn-a')">+ Add Task</button>
          <button class="cta cta-s" onclick="qprompt('What should I focus on today?');openAI()">âœ¨ Ask AI</button>
        </div>
      </div>

      <div class="stats-grid" id="dashStats"></div>

      <div class="panels-row">
        <div class="panel"><div class="panel-lbl">Task Breakdown</div><div class="chart-box"><canvas id="taskChart"></canvas></div></div>
        <div class="panel"><div class="panel-lbl">7-Day Streak</div><div class="streak-row" id="streakRow"></div><div class="streak-note">Complete tasks daily to build momentum ğŸ”¥</div></div>
      </div>

      <div class="panel"><div class="panel-lbl">Recent Activity</div><div id="recentTasks"></div></div>
    </div>

    <!-- TASKS -->
    <div class="page" id="page-tasks">
      <h1 class="pg-title"><em>Tasks</em> <span class="pg-cnt" id="taskCnt">â€”</span></h1>
      <div class="toolbar">
        <input class="srch" type="text" id="srchBox" placeholder="Search tasksâ€¦" oninput="renderTasks()">
        <div class="div-line"></div>
        <button class="chip on" onclick="setPri('all',this)">All</button>
        <button class="chip" onclick="setPri('high',this)">High</button>
        <button class="chip" onclick="setPri('medium',this)">Medium</button>
        <button class="chip" onclick="setPri('low',this)">Low</button>
        <div class="div-line"></div>
        <button class="chip" onclick="toggleSort('due')">ğŸ“… Date</button>
        <button class="chip" onclick="toggleSort('priority')">ğŸ¯ Priority</button>
      </div>
      <div class="task-grid" id="taskGrid"></div>
    </div>

    <!-- UPCOMING -->
    <div class="page" id="page-upcoming">
      <h1 class="pg-title"><em>Upcoming</em> Deadlines</h1>
      <div class="timeline" id="upcomingList"></div>
    </div>

    <!-- ADD TASK -->
    <div class="page" id="page-add">
      <h1 class="pg-title">New <em>Task</em></h1>
      <form class="form-card" onsubmit="submitTask(event)">
        <div class="fg full"><label>Task Title *</label><input type="text" id="f-title" placeholder="e.g. Write chemistry lab report" required></div>
        <div class="form-row">
          <div class="fg"><label>Subject</label><input type="text" id="f-subject" placeholder="e.g. Chemistry"></div>
          <div class="fg"><label>Due Date</label><input type="date" id="f-due"></div>
        </div>
        <div class="form-row">
          <div class="fg"><label>Priority</label>
            <select id="f-priority">
              <option value="medium">Medium</option>
              <option value="high">High</option>
              <option value="low">Low</option>
            </select>
          </div>
          <div class="fg"><label>Status</label>
            <select id="f-status">
              <option value="pending">Pending</option>
              <option value="in-progress">In Progress</option>
              <option value="completed">Completed</option>
            </select>
          </div>
        </div>
        <div class="fg full"><label>Notes</label><textarea id="f-desc" placeholder="Extra details, links, or resourcesâ€¦"></textarea></div>
        <div class="form-acts">
          <button type="button" class="btn btn-ai" onclick="aiPriority()">âœ¨ AI Priority</button>
          <button type="button" class="btn btn-s" onclick="resetForm()">Clear</button>
          <button type="submit" class="btn btn-p">Add Task â†’</button>
        </div>
      </form>
    </div>

  </main>

  <!-- RIGHT COLUMN: ACCOUNT PANEL (desktop) -->
  <aside class="account-col" id="accountCol">

    <div class="ap-sec">
      <div class="ap-head">Account</div>
      <div class="profile-card">
        <div class="profile-av" id="apAva">?</div>
        <div class="profile-info">
          <div class="profile-name" id="apName">â€”</div>
          <div class="profile-role">Student</div>
        </div>
        <div class="profile-badge"><span class="logo-dot" style="width:5px;height:5px"></span>Active</div>
      </div>
      <div class="q-stats" id="qStats"></div>
    </div>

    <div class="ap-sec">
      <div class="ap-head">AI Assistant</div>
      <div class="ai-trigger" onclick="openAI()">
        <div class="ait-ic">ğŸ¤–</div>
        <div class="ait-body">
          <span class="ait-name">StudyBot AI</span>
          <span class="ait-sub">Claude Â· Online</span>
        </div>
        <span class="ait-arr">â†’</span>
      </div>
    </div>

    <div class="ap-sec">
      <div class="ap-head">Appearance</div>
      <div class="ap-theme-grid">
        <div class="ap-th-opt on" id="ao-ink"   onclick="setTheme('ink')">  <div class="ap-sw" style="background:linear-gradient(135deg,#0d0d12 50%,#b6f040)"></div>Ink</div>
        <div class="ap-th-opt"    id="ao-paper"  onclick="setTheme('paper')"><div class="ap-sw" style="background:linear-gradient(135deg,#f3ede1 50%,#c03b12)"></div>Paper</div>
        <div class="ap-th-opt"    id="ao-slate"  onclick="setTheme('slate')"><div class="ap-sw" style="background:linear-gradient(135deg,#0c1018 50%,#4ea4ff)"></div>Slate</div>
        <div class="ap-th-opt"    id="ao-rose"   onclick="setTheme('rose')"> <div class="ap-sw" style="background:linear-gradient(135deg,#110909 50%,#ff5f7e)"></div>Rose</div>
        <div class="ap-th-opt"    id="ao-mint"   onclick="setTheme('mint')"> <div class="ap-sw" style="background:linear-gradient(135deg,#ecf4ef 50%,#077a50)"></div>Mint</div>
        <div class="ap-th-opt"    id="ao-dusk"   onclick="setTheme('dusk')"> <div class="ap-sw" style="background:linear-gradient(135deg,#0a080f 50%,#bf84ff)"></div>Dusk</div>
      </div>
    </div>

    <div class="ap-sec">
      <div class="ap-head">Actions</div>
      <button class="ap-btn" onclick="goPage('add');setHN('hn-a')">         <div class="ap-btn-ic">â•</div>Add New Task</button>
      <button class="ap-btn" onclick="goPage('upcoming');setHN('hn-u')">    <div class="ap-btn-ic">ğŸ“…</div>View Upcoming</button>
      <button class="ap-btn" onclick="filterSt(null);goPage('tasks');setHN('hn-t')"><div class="ap-btn-ic">ğŸ“‹</div>All Tasks</button>
      <button class="ap-btn" onclick="openAI()">                            <div class="ap-btn-ic">ğŸ¤–</div>Open AI Chat</button>
    </div>

    <div class="ap-sec">
      <div class="ap-head">Session</div>
      <button class="ap-btn danger" onclick="doLogout()"><div class="ap-btn-ic">ğŸšª</div>Sign Out</button>
    </div>

  </aside>

</div><!-- /app -->

<!-- BOTTOM NAV -->
<nav class="bot-nav">
  <button class="bnb on" id="bn-d"  onclick="goPage('dashboard');setBN('bn-d')"> <span class="bni">ğŸ“Š</span>Dash</button>
  <button class="bnb"    id="bn-t"  onclick="goPage('tasks');setBN('bn-t')">     <span class="bni">ğŸ“‹</span>Tasks</button>
  <button class="bnb"    id="bn-u"  onclick="goPage('upcoming');setBN('bn-u')">  <span class="bni">ğŸ“…</span>Soon</button>
  <button class="bnb"    id="bn-a"  onclick="goPage('add');setBN('bn-a')">       <span class="bni">â•</span>Add</button>
  <button class="bnb"    id="bn-ai" onclick="openAI()">                          <span class="bni">ğŸ¤–</span>AI</button>
</nav>

<!-- MOBILE ACCOUNT DRAWER (right) -->
<div class="mob-acc-drawer" id="mobAccDrawer">
  <div class="mad-top">
    <span class="mad-title">Account</span>
    <button class="mad-close" onclick="closeAccDrawer()">âœ•</button>
  </div>
  <div class="mad-body">

    <!-- Profile -->
    <div class="profile-card" style="margin-bottom:14px">
      <div class="profile-av" id="madAva">?</div>
      <div class="profile-info">
        <div class="profile-name" id="madName">â€”</div>
        <div class="profile-role">Student</div>
      </div>
    </div>

    <!-- Quick stats -->
    <div class="q-stats" id="madStats" style="margin-bottom:16px"></div>

    <!-- Theme -->
    <div class="ap-head" style="margin-bottom:10px">Appearance</div>
    <div class="ap-theme-grid" style="margin-bottom:18px">
      <div class="ap-th-opt on" id="mao-ink"   onclick="setTheme('ink')">  <div class="ap-sw" style="background:linear-gradient(135deg,#0d0d12 50%,#b6f040)"></div>Ink</div>
      <div class="ap-th-opt"    id="mao-paper"  onclick="setTheme('paper')"><div class="ap-sw" style="background:linear-gradient(135deg,#f3ede1 50%,#c03b12)"></div>Paper</div>
      <div class="ap-th-opt"    id="mao-slate"  onclick="setTheme('slate')"><div class="ap-sw" style="background:linear-gradient(135deg,#0c1018 50%,#4ea4ff)"></div>Slate</div>
      <div class="ap-th-opt"    id="mao-rose"   onclick="setTheme('rose')"> <div class="ap-sw" style="background:linear-gradient(135deg,#110909 50%,#ff5f7e)"></div>Rose</div>
      <div class="ap-th-opt"    id="mao-mint"   onclick="setTheme('mint')"> <div class="ap-sw" style="background:linear-gradient(135deg,#ecf4ef 50%,#077a50)"></div>Mint</div>
      <div class="ap-th-opt"    id="mao-dusk"   onclick="setTheme('dusk')"> <div class="ap-sw" style="background:linear-gradient(135deg,#0a080f 50%,#bf84ff)"></div>Dusk</div>
    </div>

    <!-- AI trigger -->
    <div class="ap-head" style="margin-bottom:10px">AI Assistant</div>
    <div class="ai-trigger" style="margin-bottom:18px" onclick="closeAccDrawer();openAI()">
      <div class="ait-ic">ğŸ¤–</div>
      <div class="ait-body"><span class="ait-name">StudyBot AI</span><span class="ait-sub">Claude Â· Online</span></div>
      <span class="ait-arr">â†’</span>
    </div>

    <!-- Actions -->
    <div class="ap-head" style="margin-bottom:10px">Quick Actions</div>
    <button class="ap-btn" onclick="closeAccDrawer();goPage('add');setBN('bn-a')">         <div class="ap-btn-ic">â•</div>Add New Task</button>
    <button class="ap-btn" onclick="closeAccDrawer();goPage('upcoming');setBN('bn-u')">    <div class="ap-btn-ic">ğŸ“…</div>View Upcoming</button>
    <button class="ap-btn" onclick="closeAccDrawer();filterSt(null);goPage('tasks');setBN('bn-t')"><div class="ap-btn-ic">ğŸ“‹</div>All Tasks</button>
    <button class="ap-btn danger" onclick="doLogout()">                                    <div class="ap-btn-ic">ğŸšª</div>Sign Out</button>
  </div>
</div>

<!-- AI CHAT PANEL -->
<div class="ai-panel" id="aiPanel">
  <div class="ai-hdr">
    <div class="ai-av">ğŸ¤–</div>
    <div>
      <div class="ai-title">StudyBot AI</div>
      <div class="ai-st"><span class="logo-dot" style="width:5px;height:5px"></span>Online Â· Claude</div>
    </div>
    <button class="ai-close" onclick="closeAI()">âœ•</button>
  </div>
  <div class="ai-msgs" id="aiMsgs"></div>
  <div class="qp-row">
    <button class="qbtn" onclick="qprompt('What should I focus on today?')">Focus today</button>
    <button class="qbtn" onclick="qprompt('Am I overloaded this week?')">Overloaded?</button>
    <button class="qbtn" onclick="qprompt('Show high priority tasks')">High priority</button>
    <button class="qbtn" onclick="qprompt('Build a study schedule')">Study plan</button>
    <button class="qbtn" onclick="qprompt('Which tasks are overdue?')">Overdue</button>
  </div>
  <div class="ai-inp-row">
    <input class="ai-inp" id="aiInp" type="text" placeholder="Ask anythingâ€¦" onkeydown="if(event.key==='Enter')sendMsg()">
    <button class="send-b" id="sendBtn" onclick="sendMsg()">â¤</button>
  </div>
</div>

<!-- EDIT MODAL -->
<div class="modal-bg" id="editModal">
  <div class="modal-box">
    <div class="modal-title">Edit Task</div>
    <form onsubmit="submitEdit(event)" style="display:flex;flex-direction:column;gap:13px">
      <input type="hidden" id="e-id">
      <div class="fg"><label>Title</label><input type="text" id="e-title" required></div>
      <div class="form-row">
        <div class="fg"><label>Subject</label><input type="text" id="e-sub"></div>
        <div class="fg"><label>Due Date</label><input type="date" id="e-due"></div>
      </div>
      <div class="form-row">
        <div class="fg"><label>Priority</label>
          <select id="e-pri"><option value="medium">Medium</option><option value="high">High</option><option value="low">Low</option></select>
        </div>
        <div class="fg"><label>Status</label>
          <select id="e-st"><option value="pending">Pending</option><option value="in-progress">In Progress</option><option value="completed">Completed</option></select>
        </div>
      </div>
      <div class="fg"><label>Notes</label><textarea id="e-desc"></textarea></div>
      <div class="form-acts">
        <button type="button" class="btn btn-ai" onclick="aiSubs()">âœ¨ Subtasks</button>
        <button type="button" class="btn btn-s" onclick="closeModal()">Cancel</button>
        <button type="submit" class="btn btn-p">Save â†’</button>
      </div>
    </form>
  </div>
</div>

<!-- SHARED OVERLAY (sidebar + account drawer) -->
<div class="overlay" id="overlay" onclick="closeAll()"></div>

<div class="toast-wrap" id="toastWrap"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  JAVASCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
/* â”€â”€ Storage â”€â”€ */
const LS=(k,d)=>{try{const v=JSON.parse(localStorage.getItem(k));return v===null?d:v}catch{return d}};
const LW=(k,v)=>localStorage.setItem(k,JSON.stringify(v));
const UK='sb4_u',SK='sb4_s',CK='sb4_c_',TK='sb4_t';
const getU=()=>LS(UK,{});const svU=u=>LW(UK,u);
const getS=()=>LS(SK,null);const svS=s=>LW(SK,s);const clrS=()=>localStorage.removeItem(SK);
const getChat=u=>LS(CK+u,[]);const svChat=(u,h)=>LW(CK+u,h.slice(-50));

/* â”€â”€ Theme â”€â”€ */
const THEMES=['ink','paper','slate','rose','mint','dusk'];
let chart=null;

function setTheme(t){
  if(!THEMES.includes(t))t='ink';
  document.documentElement.setAttribute('data-theme',t);
  LW(TK,t);
  THEMES.forEach(th=>{
    ['do-','ao-','mao-'].forEach(p=>document.getElementById(p+th)?.classList.toggle('on',th===t));
  });
  if(chart){chart.destroy();chart=null;buildChart();}
  closeThDrop();
}
function toggleThDrop(){document.getElementById('thDrop').classList.toggle('on')}
function closeThDrop(){document.getElementById('thDrop').classList.remove('on')}
document.addEventListener('click',e=>{if(!e.target.closest('.th-wrap'))closeThDrop()});

/* â”€â”€ Auth â”€â”€ */
let me=null;
function switchTab(t){
  document.getElementById('aTab1').classList.toggle('on',t==='login');
  document.getElementById('aTab2').classList.toggle('on',t==='register');
  document.getElementById('loginForm').style.display=t==='login'?'':'none';
  document.getElementById('regForm').style.display=t==='register'?'':'none';
}
function showSaved(){
  const keys=Object.keys(getU());
  const wrap=document.getElementById('savedWrap'),list=document.getElementById('savedList');
  if(!keys.length){wrap.style.display='none';return}
  wrap.style.display='';
  list.innerHTML=keys.map(u=>`<span class="u-chip" onclick="qlLogin('${u}')">ğŸ‘¤ ${u}</span>`).join('');
}
function qlLogin(u){document.getElementById('lU').value=u;document.getElementById('lP').focus()}
function doLogin(){
  const u=document.getElementById('lU').value.trim(),p=document.getElementById('lP').value,e=document.getElementById('lE');
  if(!u||!p){e.textContent='Please fill all fields.';return}
  const users=getU();
  if(!users[u]){e.textContent='Username not found.';return}
  if(users[u].pw!==btoa(p)){e.textContent='Incorrect password.';return}
  e.textContent='';svS({u,t:Date.now()});startApp(u);
}
function doReg(){
  const u=document.getElementById('rU').value.trim(),p=document.getElementById('rP').value,p2=document.getElementById('rP2').value,e=document.getElementById('rE');
  if(!u||!p){e.textContent='Please fill all fields.';return}
  if(u.length<3){e.textContent='Username needs 3+ chars.';return}
  if(p.length<4){e.textContent='Password needs 4+ chars.';return}
  if(p!==p2){e.textContent='Passwords do not match.';return}
  const users=getU();
  if(users[u]){e.textContent='Username already taken.';return}
  users[u]={pw:btoa(p),c:Date.now()};svU(users);
  svS({u,t:Date.now()});startApp(u);
}
function doLogout(){
  if(!confirm('Sign out?'))return;
  svChat(me,chatH);clrS();me=null;chatH=[];tasks=[];
  closeAll();closeAccDrawer();
  document.getElementById('app').style.display='none';
  document.getElementById('authScreen').style.display='flex';
  document.getElementById('lU').value='';document.getElementById('lP').value='';
  document.getElementById('lE').textContent='';showSaved();
}
function startApp(username){
  me=username;
  document.getElementById('authScreen').style.display='none';
  document.getElementById('app').style.display='grid';
  // Set name/avatar everywhere
  ['hName','apName','madName'].forEach(id=>{const el=document.getElementById(id);if(el)el.textContent=username});
  ['hAva','apAva','madAva'].forEach(id=>{const el=document.getElementById(id);if(el)el.textContent=username[0].toUpperCase()});
  chatH=getChat(username);restoreChat();
  const h=new Date().getHours();
  document.getElementById('timeGreet').textContent=h<5?'night':h<12?'morning':h<17?'afternoon':'evening';
  document.getElementById('greetName').textContent=username;
  const n=new Date();
  document.getElementById('todayTag').textContent=n.toLocaleDateString('en-GB',{weekday:'long',day:'numeric',month:'long',year:'numeric'}).toUpperCase();
  loadTasks();
  setInterval(loadTasks,30000);
  setInterval(()=>svChat(me,chatH),10000);
}

/* â”€â”€ State â”€â”€ */
let tasks=[],priF='all',stF=null,sortM=null,chatH=[];

/* â”€â”€ Utils â”€â”€ */
function toast(m,t='nf'){
  const ico={ok:'âœ“',er:'âœ•',nf:'Â·'};
  const el=document.createElement('div');el.className=`toast ${t}`;
  el.innerHTML=`<span>${ico[t]||'Â·'}</span>${m}`;
  document.getElementById('toastWrap').appendChild(el);
  setTimeout(()=>el.style.opacity='0',2700);setTimeout(()=>el.remove(),3200);
}
const esc=s=>(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
function fmtD(s){if(!s)return null;const d=new Date(s+'T00:00:00'),n=new Date(),tm=new Date();tm.setDate(n.getDate()+1);if(d.toDateString()===n.toDateString())return'Today';if(d.toDateString()===tm.toDateString())return'Tomorrow';return d.toLocaleDateString('en-GB',{day:'numeric',month:'short',year:'numeric'})}
const isOD=s=>s&&new Date(s+'T23:59:59')<new Date();
const dLeft=s=>s?Math.ceil((new Date(s+'T00:00:00')-new Date())/86400000):null;

async function api(method,path,body){
  const r=await fetch(path,{method,headers:body?{'Content-Type':'application/json'}:{},body:body?JSON.stringify(body):undefined});
  return r.json();
}
async function loadTasks(){
  try{tasks=await api('GET','/api/tasks');renderTasks();updateSB();renderDash();}
  catch{toast('Cannot connect to server','er');}
}
function updateSB(){
  const p=tasks.filter(t=>t.status==='pending').length;
  const i=tasks.filter(t=>t.status==='in-progress').length;
  const d=tasks.filter(t=>t.status==='completed').length;
  const o=tasks.filter(t=>isOD(t.due_date)&&t.status!=='completed').length;
  document.getElementById('sPend').textContent=p;
  document.getElementById('sInP').textContent=i;
  document.getElementById('sDone').textContent=d;
  document.getElementById('sOvd').textContent=o;
  document.getElementById('hBadge').innerHTML=`<strong>${tasks.length}</strong> tasks Â· <strong>${d}</strong> done`;
  const sq=`
    <div class="qs-card"><div class="qs-val a">${tasks.length}</div><div class="qs-lbl">Total</div></div>
    <div class="qs-card"><div class="qs-val a">${d}</div><div class="qs-lbl">Done</div></div>
    <div class="qs-card"><div class="qs-val">${p}</div><div class="qs-lbl">Pending</div></div>
    <div class="qs-card"><div class="qs-val ${o?'c':''}">${o}</div><div class="qs-lbl">Overdue</div></div>
  `;
  ['qStats','madStats'].forEach(id=>{const el=document.getElementById(id);if(el)el.innerHTML=sq});
}

/* â”€â”€ Dashboard â”€â”€ */
function renderDash(){
  const tot=tasks.length,done=tasks.filter(t=>t.status==='completed').length;
  const pend=tasks.filter(t=>t.status==='pending').length,inp=tasks.filter(t=>t.status==='in-progress').length;
  const hi=tasks.filter(t=>t.priority==='high'&&t.status!=='completed').length;
  const ovd=tasks.filter(t=>isOD(t.due_date)&&t.status!=='completed').length;
  const pct=tot?Math.round(done/tot*100):0;
  document.getElementById('dashMot').textContent=
    ovd>0?`${ovd} overdue task${ovd>1?'s':''} need attention.`:
    pct>=80?`${pct}% complete â€” keep it up!`:
    pct>=50?`Good progress at ${pct}%. Keep going.`:
    tot===0?`No tasks yet. Add your first one!`:
    `${pend} task${pend!==1?'s':''} pending. Let's get started.`;
  if(tot>0){
    document.getElementById('progRow').style.display='flex';
    document.getElementById('progPct').textContent=pct+'%';
    setTimeout(()=>{document.getElementById('progFill').style.width=pct+'%'},80);
  }
  document.getElementById('dashStats').innerHTML=`
    <div class="sc"><div class="sc-lbl">Total</div><div class="sc-val b">${tot}</div><div class="sc-sub">all tasks</div></div>
    <div class="sc"><div class="sc-lbl">Done</div><div class="sc-val a">${done}</div><div class="sc-sub">${pct}% rate</div></div>
    <div class="sc"><div class="sc-lbl">Pending</div><div class="sc-val">${pend}</div><div class="sc-sub">to do</div></div>
    <div class="sc"><div class="sc-lbl">Active</div><div class="sc-val">${inp}</div><div class="sc-sub">in progress</div></div>
    <div class="sc"><div class="sc-lbl">Urgent</div><div class="sc-val">${hi}</div><div class="sc-sub">high priority</div></div>
    <div class="sc"><div class="sc-lbl">Overdue</div><div class="sc-val ${ovd?'c':''}">${ovd}</div><div class="sc-sub">${ovd?'needs action':'all on track'}</div></div>
  `;
  buildChart(done,inp,pend);
  // Streak
  const days=['S','M','T','W','T','F','S'],today=new Date();let sh='';
  for(let i=6;i>=0;i--){const d=new Date(today);d.setDate(d.getDate()-i);const ds=d.toISOString().split('T')[0];const on=tasks.some(t=>t.updated_at&&t.updated_at.startsWith(ds)&&t.status==='completed');sh+=`<div class="sd ${i===0?'td':on?'on':''}" title="${ds}">${days[d.getDay()]}</div>`}
  document.getElementById('streakRow').innerHTML=sh;
  // Recent
  const rec=[...tasks].sort((a,b)=>new Date(b.updated_at)-new Date(a.updated_at)).slice(0,5);
  document.getElementById('recentTasks').innerHTML=rec.length
    ?rec.map(t=>`<div class="rec-row"><span class="rec-name">${esc(t.title)}</span><span class="badge b-${t.priority==='high'?'hi':t.priority==='medium'?'me':'lo'}" style="margin-right:5px">${t.priority}</span><span class="badge b-${t.status==='completed'?'co':t.status==='in-progress'?'ip':'pe'}">${t.status}</span></div>`).join('')
    :`<div style="color:var(--tx3);font-size:.85rem;padding:12px 0;text-align:center">No tasks yet.</div>`;
}

function buildChart(d,i,p){
  const cv=document.getElementById('taskChart');if(!cv)return;
  if(chart){chart.destroy();chart=null}
  const cs=getComputedStyle(document.documentElement);
  const a=cs.getPropertyValue('--ac').trim(),b=cs.getPropertyValue('--ac2').trim(),c=cs.getPropertyValue('--s3').trim(),t2=cs.getPropertyValue('--tx2').trim();
  chart=new Chart(cv.getContext('2d'),{
    type:'doughnut',
    data:{labels:['Done','In Progress','Pending'],datasets:[{data:[d??0,i??0,p??0],backgroundColor:[a,b,c],borderColor:'transparent',borderWidth:0,hoverOffset:5}]},
    options:{responsive:true,maintainAspectRatio:false,cutout:'70%',plugins:{legend:{position:'bottom',labels:{color:t2,font:{family:'DM Sans',size:12},padding:14,usePointStyle:true,pointStyleWidth:8}}}}
  });
}

/* â”€â”€ Tasks â”€â”€ */
function toggleSort(m){sortM=sortM===m?null:m;renderTasks()}
function renderTasks(){
  const q=(document.getElementById('srchBox')?.value||'').toLowerCase();
  let list=tasks.filter(t=>(priF==='all'||t.priority===priF)&&(!stF||t.status===stF)&&(!q||t.title.toLowerCase().includes(q)||(t.subject||'').toLowerCase().includes(q)||(t.description||'').toLowerCase().includes(q)));
  if(sortM==='due')list.sort((a,b)=>{if(!a.due_date&&!b.due_date)return 0;if(!a.due_date)return 1;if(!b.due_date)return-1;return new Date(a.due_date)-new Date(b.due_date)});
  else if(sortM==='priority'){const o={high:0,medium:1,low:2};list.sort((a,b)=>(o[a.priority]||1)-(o[b.priority]||1))}
  const el=document.getElementById('taskGrid'),cnt=document.getElementById('taskCnt');
  if(cnt)cnt.textContent=`${list.length} task${list.length!==1?'s':''}`;
  if(!list.length){el.innerHTML=`<div class="empty-st"><span class="empty-ico">ğŸ“­</span><div class="empty-txt">No tasks found.</div></div>`;return}
  el.innerHTML=list.map((t,i)=>tCard(t,i)).join('');
}

function tCard(t,idx){
  const od=isOD(t.due_date)&&t.status!=='completed',dl=dLeft(t.due_date);
  let ds='';if(t.due_date){if(od)ds='âš  Overdue';else if(dl===0)ds='ğŸ“… Due today';else if(dl===1)ds='ğŸ“… Tomorrow';else if(dl!==null&&dl<=3)ds=`ğŸ“… ${dl} days left`;else ds=`ğŸ“… ${fmtD(t.due_date)}`}
  const sd=(t.subtasks||[]).filter(s=>s.done).length,stt=(t.subtasks||[]).length;
  const subs=(t.subtasks||[]).map((s,i)=>`<div class="sub-item ${s.done?'done':''}" onclick="togSub('${t.id}',${i})"><div class="sub-ck">${s.done?'âœ“':''}</div><span>${esc(s.text)}</span></div>`).join('');
  const bc=t.status==='completed'?'co':t.status==='in-progress'?'ip':'pe';
  return`<div class="tc p-${t.priority} ${t.status==='completed'?'done-c':''}" style="animation-delay:${idx*.032}s">
    <div class="tc-top">
      <div class="tc-title">${esc(t.title)}</div>
      <div class="tc-acts">
        <button class="ib ai" onclick="editSubs('${t.id}')" title="AI subtasks">âœ¨</button>
        <button class="ib"    onclick="openEdit('${t.id}')" title="Edit">âœ</button>
        <button class="ib"    onclick="qDone('${t.id}')"   title="Toggle done">âœ…</button>
        <button class="ib del" onclick="delTask('${t.id}')" title="Delete">âœ•</button>
      </div>
    </div>
    ${t.description?`<div class="tc-desc">${esc(t.description)}</div>`:''}
    <div class="tc-meta">
      ${t.subject?`<span class="badge b-sub">${esc(t.subject)}</span>`:''}
      <span class="badge b-${t.priority==='high'?'hi':t.priority==='medium'?'me':'lo'}">${t.priority}</span>
      <span class="badge b-${bc}">${t.status}</span>
      ${stt>0?`<span class="badge b-pe">${sd}/${stt}</span>`:''}
    </div>
    ${ds?`<div class="tc-due ${od?'od':''}">${ds}</div>`:''}
    ${subs?`<div class="sub-list">${subs}</div>`:''}
  </div>`;
}

/* â”€â”€ Navigation â”€â”€ */
function goPage(name,btn){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('on'));
  document.querySelectorAll('.nav-item').forEach(b=>b.classList.remove('on'));
  document.getElementById('page-'+name)?.classList.add('on');
  if(btn)btn.classList.add('on');
  else document.querySelector(`[data-p="${name}"]`)?.classList.add('on');
  if(name==='upcoming')loadUpcoming();
  if(name==='dashboard')renderDash();
  if(name==='tasks')renderTasks();
  closeSB();
}
function setHN(id){document.querySelectorAll('.hn').forEach(b=>b.classList.remove('on'));document.getElementById(id)?.classList.add('on')}
function setBN(id){document.querySelectorAll('.bnb').forEach(b=>b.classList.remove('on'));document.getElementById(id)?.classList.add('on')}

/* Sidebar toggle â€” FIXED for mobile */
function toggleSB(){
  const sb=document.getElementById('sidebar');
  const ov=document.getElementById('overlay');
  const open=!sb.classList.contains('on');
  if(open){sb.classList.add('on');ov.classList.add('on');}
  else{sb.classList.remove('on');ov.classList.remove('on');}
}
function closeSB(){
  document.getElementById('sidebar').classList.remove('on');
  // Only remove overlay if account drawer is also closed
  if(!document.getElementById('mobAccDrawer').classList.contains('on')&&!document.getElementById('aiPanel').classList.contains('on')){
    document.getElementById('overlay').classList.remove('on');
  }
}

function openAccDrawer(){
  closeSB();
  document.getElementById('mobAccDrawer').classList.add('on');
  document.getElementById('overlay').classList.add('on');
}
function closeAccDrawer(){
  document.getElementById('mobAccDrawer').classList.remove('on');
  if(!document.getElementById('sidebar').classList.contains('on')&&!document.getElementById('aiPanel').classList.contains('on')){
    document.getElementById('overlay').classList.remove('on');
  }
}

function openAI(){
  document.getElementById('aiPanel').classList.add('on');
  // Don't use overlay for AI panel so content stays accessible
  setTimeout(()=>document.getElementById('aiInp').focus(),300);
}
function closeAI(){document.getElementById('aiPanel').classList.remove('on')}

function closeAll(){
  document.getElementById('sidebar').classList.remove('on');
  document.getElementById('mobAccDrawer').classList.remove('on');
  document.getElementById('overlay').classList.remove('on');
}

async function loadUpcoming(){
  try{
    const items=await api('GET','/api/upcoming?days=14');
    const list=document.getElementById('upcomingList');
    if(!items.length){list.innerHTML=`<div class="empty-st"><span class="empty-ico">ğŸ‰</span><div class="empty-txt">Nothing due in 2 weeks!</div></div>`;return}
    list.innerHTML=items.map((t,i)=>{
      const d=new Date(t.due_date+'T00:00:00'),dl=dLeft(t.due_date);
      const bc=t.status==='completed'?'co':t.status==='in-progress'?'ip':'pe';
      return`<div class="tl" style="animation-delay:${i*.05}s">
        <div class="tl-date"><div class="tl-day">${d.getDate()}</div><div class="tl-mon">${d.toLocaleString('en',{month:'short'})}</div></div>
        <div class="tl-body"><div class="tl-title">${esc(t.title)}</div>
        <div class="tc-meta">${t.subject?`<span class="badge b-sub">${esc(t.subject)}</span>`:''}<span class="badge b-${t.priority==='high'?'hi':t.priority==='medium'?'me':'lo'}">${t.priority}</span><span class="badge b-${bc}">${t.status}</span>${dl===0?`<span class="badge b-sub">TODAY</span>`:''}</div></div>
        <div class="tl-acts"><button class="ib" onclick="openEdit('${t.id}')">âœ</button><button class="ib" onclick="qDone('${t.id}')">âœ…</button></div>
      </div>`;}).join('');
  }catch{toast('Error loading upcoming','er')}
}

function setPri(v,btn){priF=v;document.querySelectorAll('.chip').forEach(c=>c.classList.remove('on'));if(btn)btn.classList.add('on');renderTasks()}
function filterSt(v){stF=v;goPage('tasks');setHN('hn-t')}

/* â”€â”€ CRUD â”€â”€ */
async function submitTask(e){
  e.preventDefault();
  const data={title:document.getElementById('f-title').value,subject:document.getElementById('f-subject').value,due_date:document.getElementById('f-due').value||null,priority:document.getElementById('f-priority').value,status:document.getElementById('f-status').value,description:document.getElementById('f-desc').value};
  const r=await api('POST','/api/tasks',data);
  if(r.error){toast(r.error,'er');return}
  toast('Task added âœ“','ok');resetForm();await loadTasks();
  goPage('tasks');setHN('hn-t');setBN('bn-t');
}
function resetForm(){['f-title','f-subject','f-due','f-desc'].forEach(id=>document.getElementById(id).value='');document.getElementById('f-priority').value='medium';document.getElementById('f-status').value='pending'}
async function delTask(id){if(!confirm('Delete this task?'))return;await api('DELETE',`/api/tasks/${id}`);toast('Deleted','nf');await loadTasks()}
async function qDone(id){const t=tasks.find(t=>t.id===id);if(!t)return;const ns=t.status==='completed'?'pending':'completed';await api('PUT',`/api/tasks/${id}`,{status:ns});toast(ns==='completed'?'Done âœ“':'Reopened','ok');await loadTasks()}
function togSub(tid,idx){const t=tasks.find(t=>t.id===tid);if(!t||!t.subtasks)return;t.subtasks[idx].done=!t.subtasks[idx].done;renderTasks()}
function openEdit(id){
  const t=tasks.find(t=>t.id===id);if(!t)return;
  document.getElementById('e-id').value=t.id;document.getElementById('e-title').value=t.title;
  document.getElementById('e-sub').value=t.subject||'';document.getElementById('e-due').value=t.due_date||'';
  document.getElementById('e-pri').value=t.priority;document.getElementById('e-st').value=t.status;
  document.getElementById('e-desc').value=t.description||'';
  document.getElementById('editModal').classList.add('on');
}
function closeModal(){document.getElementById('editModal').classList.remove('on')}
async function submitEdit(e){
  e.preventDefault();const id=document.getElementById('e-id').value;
  const data={title:document.getElementById('e-title').value,subject:document.getElementById('e-sub').value,due_date:document.getElementById('e-due').value||null,priority:document.getElementById('e-pri').value,status:document.getElementById('e-st').value,description:document.getElementById('e-desc').value};
  const r=await api('PUT',`/api/tasks/${id}`,data);if(r.error){toast(r.error,'er');return}
  toast('Saved âœ“','ok');closeModal();await loadTasks();
}

/* â”€â”€ AI â”€â”€ */
async function aiPriority(){
  const t=document.getElementById('f-title').value;if(!t){toast('Enter a title first','nf');return}
  toast('Asking AIâ€¦','nf');
  try{const r=await api('POST','/api/ai/chat',{message:`Reply with ONLY one word (low/medium/high) for priority: "${t}", subject:"${document.getElementById('f-subject').value}"`,history:[]});const w=r.reply?.toLowerCase().match(/\b(low|medium|high)\b/);if(w){document.getElementById('f-priority').value=w[0];toast(`AI suggests: ${w[0]}`,'ok')}}
  catch{toast('AI unavailable','er')}
}
async function editSubs(id){openEdit(id);await aiSubsFor(id)}
async function aiSubs(){await aiSubsFor(document.getElementById('e-id').value)}
async function aiSubsFor(id){
  toast('Generating subtasksâ€¦','nf');
  try{const r=await api('POST',`/api/ai/subtasks/${id}`);if(r.error){toast(r.error,'er');return}const t=tasks.find(t=>t.id===id);if(t){t.subtasks=r.subtasks.map(s=>({text:s,done:false}));renderTasks();toast(`${r.subtasks.length} subtasks âœ“`,'ok')}}
  catch{toast('AI unavailable','er')}
}

/* â”€â”€ AI Chat â”€â”€ */
async function sendMsg(){
  const inp=document.getElementById('aiInp'),msg=inp.value.trim();if(!msg)return;
  inp.value='';addMsg('usr',msg);chatH.push({role:'user',content:msg});
  document.getElementById('sendBtn').disabled=true;
  const tid='t-'+Date.now();
  document.getElementById('aiMsgs').insertAdjacentHTML('beforeend',`<div class="msg ai" id="${tid}"><div class="msg-av">ğŸ¤–</div><div class="msg-bub"><div class="typing"><div class="tdot"></div><div class="tdot"></div><div class="tdot"></div></div></div></div>`);
  scrollAI();
  try{const r=await api('POST','/api/ai/chat',{message:msg,history:chatH.slice(-12)});document.getElementById(tid)?.remove();const rep=r.reply||r.error||'Something went wrong.';addMsg('ai',rep);chatH.push({role:'assistant',content:rep});svChat(me,chatH)}
  catch{document.getElementById(tid)?.remove();addMsg('ai','âš  Could not reach server.')}
  document.getElementById('sendBtn').disabled=false;
}
function addMsg(role,text){
  const ai=role==='ai';
  document.getElementById('aiMsgs').insertAdjacentHTML('beforeend',`<div class="msg ${role==='ai'?'ai':'usr'}">${ai?'<div class="msg-av">ğŸ¤–</div>':''}<div class="msg-bub">${esc(text).replace(/\n/g,'<br>')}</div>${!ai?'<div class="msg-av">ğŸ§‘</div>':''}</div>`);
  scrollAI();
}
function scrollAI(){const el=document.getElementById('aiMsgs');el.scrollTop=el.scrollHeight}
function qprompt(t){document.getElementById('aiInp').value=t;sendMsg()}
function restoreChat(){
  const c=document.getElementById('aiMsgs');c.innerHTML='';
  if(!chatH.length){c.innerHTML=`<div class="msg ai"><div class="msg-av">ğŸ¤–</div><div class="msg-bub">Hi! I'm <strong>StudyBot AI</strong>.<br><br>I can see all your tasks and help you plan, prioritise, and stay on track. What can I help with?</div></div>`;return}
  chatH.forEach(m=>addMsg(m.role==='assistant'?'ai':'usr',m.content));
}

/* â”€â”€ Init â”€â”€ */
(function(){
  setTheme(LS(TK,'ink'));
  showSaved();
  const s=getS();
  if(s?.u){const u=getU();if(u[s.u])startApp(s.u);else clrS()}
})();
</script>
</body>
</html>