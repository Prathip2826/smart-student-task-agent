<!DOCTYPE html>
<html lang="en" data-theme="midnight" data-font="grotesk">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>StudyBot | AI-Powered Study Task Manager</title>
<meta name="description" content="StudyBot - AI-powered smart study task management system for students"/>
<meta name="keywords" content="task manager, study planner, AI, student"/>
<meta name="author" content="StudyBot Team"/>
<meta property="og:title" content="StudyBot | AI Study Manager"/>
<meta property="og:type" content="website"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Space+Grotesk:wght@300;400;600;700&family=Manrope:wght@300;400;600;700&family=Orbitron:wght@400;600;700&family=Lora:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Cabinet+Grotesk:wght@300;400;500;700;800;900&family=Syne:wght@400;600;700;800&family=DM+Mono:wght@400;500&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Unbounded:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js" defer></script>
<style>
/* â”€â”€â”€ RESET â”€â”€â”€ */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth;font-size:16px}

/* â”€â”€â”€ THEME SYSTEM â”€â”€â”€ */
:root,[data-theme="midnight"]{
  --bg:#0d0f14;--bg2:#141720;--bg3:#1c2030;--bg4:#252a3a;
  --tx:#f0f2f8;--tx2:#b8bdd4;--tx3:#6b7298;--tx4:#3d4366;
  --acc:#5b6ef5;--acc2:#7b8ef7;--acc3:#a5b0fb;
  --acc-r:#f55b5b;--acc-g:#5bf5a0;--acc-y:#f5c45b;--acc-p:#c45bf5;
  --card:#1c2030;--border:#252a3a;--shadow:0 4px 24px rgba(0,0,0,0.5);
  --font:'Cabinet Grotesk',sans-serif;--font-head:'Syne',sans-serif;--font-mono:'DM Mono',monospace;
  --radius:12px;--radius-sm:8px;--radius-lg:18px;
}
[data-theme="light"]{
  --bg:#f6f8fc;--bg2:#eef1f8;--bg3:#ffffff;--bg4:#e6eaf5;
  --tx:#1a1f36;--tx2:#3a4060;--tx3:#6b7298;--tx4:#9aa1c6;
  --acc:#4f63ff;--acc2:#6c7cff;--acc3:#aab4ff;
  --acc-r:#ff5b5b;--acc-g:#22c55e;--acc-y:#f59e0b;--acc-p:#a855f7;
  --card:#ffffff;--border:#e2e6f2;--shadow:0 8px 30px rgba(60,72,100,0.08);
  --font:'Cabinet Grotesk',sans-serif;--font-head:'Syne',sans-serif;--font-mono:'DM Mono',monospace;
  --radius:12px;--radius-sm:8px;--radius-lg:18px;
}

[data-theme="aurora"]{
  --bg:#080e1a;--bg2:#0d1525;--bg3:#111d32;--bg4:#1a2a45;
  --tx:#e8f4ff;--tx2:#9ec8f0;--tx3:#4d7aaa;--tx4:#2d4d70;
  --acc:#00d4ff;--acc2:#33deff;--acc3:#80ebff;
  --acc-r:#ff6b6b;--acc-g:#51fa8a;--acc-y:#ffd166;--acc-p:#c77dff;
  --card:#0d1525;--border:#1a2a45;--shadow:0 4px 24px rgba(0,10,40,0.6);
}
[data-theme="solar"]{
  --bg:#0f0a00;--bg2:#1a1200;--bg3:#241a00;--bg4:#302400;
  --tx:#fff8e8;--tx2:#d4b86a;--tx3:#8a6a20;--tx4:#4a3a10;
  --acc:#f5a623;--acc2:#f7b84a;--acc3:#f9ce80;
  --acc-r:#f55b5b;--acc-g:#5bf5a0;--acc-y:#f5e45b;--acc-p:#c45bf5;
  --card:#1a1200;--border:#302400;--shadow:0 4px 24px rgba(30,15,0,0.6);
}
[data-theme="paper"]{
  --bg:#f5f0e8;--bg2:#ede7db;--bg3:#e4ddd1;--bg4:#d8d0c2;
  --tx:#1a1610;--tx2:#3d3628;--tx3:#7a6f58;--tx4:#b0a890;
  --acc:#2d5016;--acc2:#4a7a28;--acc3:#6fa040;
  --acc-r:#b52020;--acc-g:#206020;--acc-y:#b08020;--acc-p:#602080;
  --card:#ede7db;--border:#d8d0c2;--shadow:0 4px 24px rgba(0,0,0,0.12);
}
[data-theme="rose"]{
  --bg:#0f080e;--bg2:#1a0f18;--bg3:#251524;--bg4:#321c30;
  --tx:#ffe8f8;--tx2:#d4a8c8;--tx3:#8a5878;--tx4:#4a2840;
  --acc:#f56ab0;--acc2:#f78ec0;--acc3:#fab8d8;
  --acc-r:#f55b5b;--acc-g:#5bf5a0;--acc-y:#f5c45b;--acc-p:#c45bf5;
  --card:#1a0f18;--border:#321c30;--shadow:0 4px 24px rgba(30,5,25,0.6);
}
[data-theme="slate"]{
  --bg:#0a0c10;--bg2:#10131a;--bg3:#161b26;--bg4:#1d2336;
  --tx:#dde8f8;--tx2:#8a9dc0;--tx3:#455880;--tx4:#243048;
  --acc:#42a5f5;--acc2:#64b5f6;--acc3:#90caf9;
  --acc-r:#ef5350;--acc-g:#66bb6a;--acc-y:#ffa726;--acc-p:#ab47bc;
  --card:#10131a;--border:#1d2336;--shadow:0 4px 24px rgba(0,0,0,0.5);
}
[data-theme="sky"]{
  --bg:#f0f7ff;--bg2:#e0efff;--bg3:#ffffff;--bg4:#cce3ff;
  --tx:#0a2540;--tx2:#1e4080;--tx3:#4a7ab5;--tx4:#90b8e0;
  --acc:#0066ff;--acc2:#3388ff;--acc3:#99c4ff;
  --acc-r:#ff3b3b;--acc-g:#00c96e;--acc-y:#ffaa00;--acc-p:#8855ff;
  --card:#ffffff;--border:#bcd8f8;--shadow:0 8px 32px rgba(0,80,200,0.1);
  --font:'Cabinet Grotesk',sans-serif;--font-head:'Syne',sans-serif;--font-mono:'DM Mono',monospace;
  --radius:12px;--radius-sm:8px;--radius-lg:18px;
}
[data-theme="mint"]{
  --bg:#f0fff8;--bg2:#e0fff2;--bg3:#ffffff;--bg4:#b8f5dc;
  --tx:#042a18;--tx2:#0f5c38;--tx3:#3a9e6a;--tx4:#80cfaa;
  --acc:#00b86e;--acc2:#00d47e;--acc3:#80e8be;
  --acc-r:#f53b3b;--acc-g:#00b86e;--acc-y:#e8a800;--acc-p:#9055f5;
  --card:#ffffff;--border:#a8eece;--shadow:0 8px 32px rgba(0,140,80,0.1);
  --font:'Cabinet Grotesk',sans-serif;--font-head:'Syne',sans-serif;--font-mono:'DM Mono',monospace;
  --radius:12px;--radius-sm:8px;--radius-lg:18px;
}
[data-theme="peach"]{
  --bg:#fff8f0;--bg2:#fff0e0;--bg3:#ffffff;--bg4:#ffd8b0;
  --tx:#2a1200;--tx2:#6b3010;--tx3:#b06030;--tx4:#d8a078;
  --acc:#ff7020;--acc2:#ff8c40;--acc3:#ffbe90;
  --acc-r:#e83030;--acc-g:#28b84a;--acc-y:#f5a800;--acc-p:#9030d0;
  --card:#ffffff;--border:#f5c898;--shadow:0 8px 32px rgba(200,80,0,0.1);
  --font:'Cabinet Grotesk',sans-serif;--font-head:'Syne',sans-serif;--font-mono:'DM Mono',monospace;
  --radius:12px;--radius-sm:8px;--radius-lg:18px;
}
[data-theme="lavender"]{
  --bg:#f8f0ff;--bg2:#f0e4ff;--bg3:#ffffff;--bg4:#ddc4ff;
  --tx:#1a0835;--tx2:#4a1880;--tx3:#8850c0;--tx4:#bb98e8;
  --acc:#8020ff;--acc2:#a040ff;--acc3:#cc90ff;
  --acc-r:#f53b5a;--acc-g:#20c070;--acc-y:#f0a800;--acc-p:#8020ff;
  --card:#ffffff;--border:#ccaaff;--shadow:0 8px 32px rgba(100,0,220,0.1);
  --font:'Cabinet Grotesk',sans-serif;--font-head:'Syne',sans-serif;--font-mono:'DM Mono',monospace;
  --radius:12px;--radius-sm:8px;--radius-lg:18px;
}
[data-theme="lemon"]{
  --bg:#fffef0;--bg2:#fffce0;--bg3:#ffffff;--bg4:#fff5a8;
  --tx:#1a1800;--tx2:#4a4400;--tx3:#8a8020;--tx4:#c0b840;
  --acc:#c8a800;--acc2:#e8c800;--acc3:#f8e860;
  --acc-r:#e83030;--acc-g:#28b050;--acc-y:#c8a800;--acc-p:#8030c8;
  --card:#ffffff;--border:#f0e060;--shadow:0 8px 32px rgba(160,130,0,0.1);
  --font:'Cabinet Grotesk',sans-serif;--font-head:'Syne',sans-serif;--font-mono:'DM Mono',monospace;
  --radius:12px;--radius-sm:8px;--radius-lg:18px;
}
[data-theme="blush"]{
  --bg:#fff0f5;--bg2:#ffe4ef;--bg3:#ffffff;--bg4:#ffc0d8;
  --tx:#2a0818;--tx2:#7a1840;--tx3:#c04878;--tx4:#e090b0;
  --acc:#e8006a;--acc2:#ff2080;--acc3:#ff80b8;
  --acc-r:#e8003a;--acc-g:#20b860;--acc-y:#f5a800;--acc-p:#9020e8;
  --card:#ffffff;--border:#f5a0c8;--shadow:0 8px 32px rgba(220,0,100,0.1);
  --font:'Cabinet Grotesk',sans-serif;--font-head:'Syne',sans-serif;--font-mono:'DM Mono',monospace;
  --radius:12px;--radius-sm:8px;--radius-lg:18px;
}
[data-theme="cloud"]{
  --bg:#f5f7fa;--bg2:#ebeef5;--bg3:#ffffff;--bg4:#d8ddf0;
  --tx:#10152a;--tx2:#303868;--tx3:#6068a8;--tx4:#a0a8d8;
  --acc:#4455ee;--acc2:#6670f8;--acc3:#a8b0ff;
  --acc-r:#ee3344;--acc-g:#20c068;--acc-y:#f8a820;--acc-p:#9930ee;
  --card:#ffffff;--border:#c8ccee;--shadow:0 8px 32px rgba(40,60,180,0.08);
  --font:'Cabinet Grotesk',sans-serif;--font-head:'Syne',sans-serif;--font-mono:'DM Mono',monospace;
  --radius:12px;--radius-sm:8px;--radius-lg:18px;
}

/* â”€â”€â”€ FONT THEMES â”€â”€â”€ */
[data-font="grotesk"]{--font:'Cabinet Grotesk',sans-serif;--font-head:'Syne',sans-serif}
[data-font="playfair"]{--font:'Playfair Display',serif;--font-head:'Playfair Display',serif}
[data-font="unbounded"]{--font:'Unbounded',sans-serif;--font-head:'Unbounded',sans-serif;font-size:14px}
[data-font="mono"]{--font:'DM Mono',monospace;--font-head:'DM Mono',monospace}
[data-font="inter"]{--font:'Inter',sans-serif;--font-head:'Inter',sans-serif;}
[data-font="space"]{--font:'Space Grotesk',sans-serif;--font-head:'Space Grotesk',sans-serif;}
[data-font="manrope"]{--font:'Manrope',sans-serif;--font-head:'Manrope',sans-serif;}
[data-font="orbitron"]{--font:'Orbitron',sans-serif;--font-head:'Orbitron',sans-serif;}
[data-font="lora"]{--font:'Lora',serif;--font-head:'Lora',serif;}
[data-font="outfit"]{--font:'Outfit',sans-serif;--font-head:'Outfit',sans-serif;}
[data-font="jakarta"]{--font:'Plus Jakarta Sans',sans-serif;--font-head:'Plus Jakarta Sans',sans-serif;}
[data-font="lexend"]{--font:'Lexend',sans-serif;--font-head:'Lexend',sans-serif;}
[data-font="nunito"]{--font:'Nunito',sans-serif;--font-head:'Nunito',sans-serif;}
[data-font="raleway"]{--font:'Raleway',sans-serif;--font-head:'Raleway',sans-serif;}
[data-font="josefin"]{--font:'Josefin Sans',sans-serif;--font-head:'Josefin Sans',sans-serif;}
[data-font="quicksand"]{--font:'Quicksand',sans-serif;--font-head:'Quicksand',sans-serif;}
[data-font="righteous"]{--font:'Righteous',sans-serif;--font-head:'Righteous',sans-serif;}
[data-font="comfortaa"]{--font:'Comfortaa',sans-serif;--font-head:'Comfortaa',sans-serif;}


/* â”€â”€â”€ BASE â”€â”€â”€ */
body{background:var(--bg);color:var(--tx);font-family:var(--font);line-height:1.6;-webkit-font-smoothing:antialiased;min-height:100vh;overflow-x:hidden}
button{cursor:pointer;font-family:var(--font)}
input,textarea,select{font-family:var(--font)}
a{color:var(--acc);text-decoration:none}
code{font-family:var(--font-mono);font-size:0.85em;background:var(--bg4);padding:2px 6px;border-radius:4px}

/* â”€â”€â”€ SCROLLBAR â”€â”€â”€ */
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}

/* â”€â”€â”€ ANIMATIONS â”€â”€â”€ */
@keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
@keyframes pageIn{from{opacity:0;transform:translateX(-8px)}to{opacity:1;transform:translateX(0)}}
@keyframes slideRight{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}
@keyframes slideLeft{from{transform:translateX(-100%);opacity:0}to{transform:translateX(0);opacity:1}}
@keyframes spin{to{transform:rotate(360deg)}}
@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}
@keyframes toastIn{from{transform:translateX(120%);opacity:0}to{transform:translateX(0);opacity:1}}
@keyframes toastOut{from{transform:translateX(0);opacity:1}to{transform:translateX(120%);opacity:0}}
@keyframes dot{0%,80%,100%{transform:scale(0.6);opacity:0.4}40%{transform:scale(1);opacity:1}}
@keyframes ringFill{from{stroke-dashoffset:251}to{stroke-dashoffset:var(--ring-offset)}}
@keyframes heatIn{from{opacity:0;transform:scale(0.8)}to{opacity:1;transform:scale(1)}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LANDING PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#landingPage{animation:fadeIn 0.5s ease}
.landing-header{display:flex;align-items:center;justify-content:space-between;padding:20px 48px;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:50;background:rgba(13,15,20,0.85);backdrop-filter:blur(12px)}
.landing-logo{font-family:var(--font-head);font-size:1.4rem;font-weight:800;color:var(--tx);display:flex;align-items:center;gap:8px}
.logo-dot{width:10px;height:10px;border-radius:50%;background:var(--acc);display:inline-block;animation:bounce 2s infinite}
.landing-nav{display:flex;align-items:center;gap:28px}
.landing-nav a{font-size:0.875rem;font-weight:500;color:var(--tx2);transition:color 0.2s}
.landing-nav a:hover{color:var(--tx)}
.landing-nav .btn-cta{background:var(--acc);color:#fff;padding:9px 22px;border-radius:100px;font-weight:700;font-size:0.875rem;transition:all 0.2s;border:none}
.landing-nav .btn-cta:hover{opacity:0.88;transform:translateY(-1px)}

.hero{padding:100px 48px 80px;text-align:center;position:relative;overflow:hidden}
.hero::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse 60% 50% at 50% 0%, rgba(91,110,245,0.15) 0%, transparent 70%);pointer-events:none}
.hero-badge{display:inline-flex;align-items:center;gap:6px;padding:6px 16px;border-radius:100px;border:1px solid var(--border);font-size:0.75rem;font-weight:600;color:var(--tx3);letter-spacing:1.5px;text-transform:uppercase;margin-bottom:28px;background:var(--bg2)}
.hero-title{font-family:var(--font-head);font-size:clamp(2.8rem,6vw,5rem);font-weight:800;line-height:1.05;letter-spacing:-2px;margin-bottom:24px;color:var(--tx)}
.hero-title span{color:var(--acc)}
.hero-sub{font-size:1.1rem;color:var(--tx2);max-width:560px;margin:0 auto 44px;line-height:1.7}
.hero-btns{display:flex;gap:14px;justify-content:center;flex-wrap:wrap}
.btn-hero{padding:14px 32px;border-radius:100px;font-size:1rem;font-weight:700;border:none;transition:all 0.2s;cursor:pointer;font-family:var(--font)}
.btn-hero.primary{background:var(--acc);color:#fff}
.btn-hero.primary:hover{opacity:0.88;transform:translateY(-2px);box-shadow:0 8px 24px rgba(91,110,245,0.35)}
.btn-hero.secondary{background:var(--bg3);color:var(--tx);border:1px solid var(--border)}
.btn-hero.secondary:hover{background:var(--bg4)}

.features{padding:80px 48px;display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px;max-width:1100px;margin:0 auto}
.feature-card{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius-lg);padding:28px;transition:all 0.25s}
.feature-card:hover{border-color:var(--acc);transform:translateY(-3px);box-shadow:var(--shadow)}
.feature-icon{font-size:2rem;margin-bottom:14px}
.feature-title{font-family:var(--font-head);font-size:1.1rem;font-weight:700;margin-bottom:8px}
.feature-desc{font-size:0.875rem;color:var(--tx2);line-height:1.6}

.landing-cta-sec{text-align:center;padding:60px 48px 80px}
.landing-cta-sec h2{font-family:var(--font-head);font-size:2.2rem;font-weight:800;margin-bottom:16px}
.landing-cta-sec p{color:var(--tx2);margin-bottom:32px;font-size:1rem}

.landing-footer{border-top:1px solid var(--border);padding:24px 48px;display:flex;align-items:center;justify-content:space-between;font-size:0.8rem;color:var(--tx3)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AUTH PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#authPage{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px;background:var(--bg);animation:fadeIn 0.4s ease}
.auth-box{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius-lg);padding:44px 40px;width:100%;max-width:420px;box-shadow:var(--shadow)}
.auth-logo{font-family:var(--font-head);font-size:1.5rem;font-weight:800;text-align:center;margin-bottom:8px}
.auth-sub{text-align:center;color:var(--tx3);font-size:0.875rem;margin-bottom:28px}
.auth-tabs{display:flex;gap:4px;background:var(--bg3);border-radius:var(--radius-sm);padding:4px;margin-bottom:28px}
.auth-tab{flex:1;padding:9px;border-radius:6px;border:none;background:transparent;color:var(--tx3);font-weight:600;font-size:0.875rem;cursor:pointer;transition:all 0.2s;font-family:var(--font)}
.auth-tab.active{background:var(--acc);color:#fff}
.form-group{margin-bottom:16px}
.form-group label{display:block;font-size:0.8rem;font-weight:600;color:var(--tx2);margin-bottom:6px;letter-spacing:0.3px}
.form-input{width:100%;padding:11px 14px;background:var(--bg3);border:1.5px solid var(--border);border-radius:var(--radius-sm);color:var(--tx);font-size:0.9rem;transition:all 0.2s;outline:none;font-family:var(--font)}
.form-input:focus{border-color:var(--acc);background:var(--bg4);box-shadow:0 0 0 3px rgba(91,110,245,0.12)}
.form-input::placeholder{color:var(--tx4)}
.form-error{font-size:0.75rem;color:var(--acc-r);margin-top:4px;display:none}
.btn-submit{width:100%;padding:12px;background:var(--acc);color:#fff;border:none;border-radius:var(--radius-sm);font-weight:700;font-size:0.95rem;cursor:pointer;transition:all 0.2s;margin-top:4px;font-family:var(--font)}
.btn-submit:hover{opacity:0.88}
.quick-logins{margin-top:20px}
.ql-label{font-size:0.72rem;color:var(--tx3);text-align:center;margin-bottom:8px;text-transform:uppercase;letter-spacing:1px}
.ql-chips{display:flex;flex-wrap:wrap;gap:6px;justify-content:center}
.ql-chip{padding:5px 12px;background:var(--bg3);border:1px solid var(--border);border-radius:100px;font-size:0.78rem;color:var(--tx2);cursor:pointer;transition:all 0.2s}
.ql-chip:hover{border-color:var(--acc);color:var(--acc)}
.back-to-landing{text-align:center;margin-top:20px;font-size:0.8rem;color:var(--tx3)}
.back-to-landing a{color:var(--acc2)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   APP SHELL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#mainApp{display:none;grid-template-columns:248px 1fr 0px;height:100vh;overflow:hidden}
#mainApp.app-visible{display:grid}
#mainApp.ai-open{grid-template-columns:248px 1fr 340px}
#mainApp.sidebar-hidden{grid-template-columns:0px 1fr 0px}
#mainApp.sidebar-hidden.ai-open{grid-template-columns:0px 1fr 340px}

/* â”€â”€â”€ SIDEBAR â”€â”€â”€ */
.sidebar{background:var(--bg2);border-right:1px solid var(--border);display:flex;flex-direction:column;overflow:hidden;transition:all 0.3s;z-index:30}
.sidebar-top{padding:20px 16px 12px;border-bottom:1px solid var(--border);flex-shrink:0}
.sidebar-logo{font-family:var(--font-head);font-size:1.25rem;font-weight:800;display:flex;align-items:center;gap:8px;padding:4px 0 12px}
.nav-section{padding:10px 0}
.nav-label{font-size:0.65rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--tx4);padding:0 12px 6px}
.nav-item{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:var(--radius-sm);color:var(--tx2);font-size:0.875rem;font-weight:500;cursor:pointer;transition:all 0.15s;border:none;background:transparent;width:100%;text-align:left;font-family:var(--font)}
.nav-item:hover{background:var(--bg3);color:var(--tx)}
.nav-item.active{background:linear-gradient(135deg,rgba(91,110,245,0.2),rgba(91,110,245,0.08));color:var(--acc);font-weight:700;border-left:2px solid var(--acc)}
.nav-item .nav-icon{font-size:1.05rem;width:20px;text-align:center;flex-shrink:0}
.sidebar-bottom{padding:12px 16px;border-top:1px solid var(--border);margin-top:auto;flex-shrink:0}
.user-chip{display:flex;align-items:center;gap:10px;padding:10px;border-radius:var(--radius-sm);background:var(--bg3);cursor:pointer;transition:all 0.2s}
.user-chip:hover{background:var(--bg4)}
.user-av{width:34px;height:34px;border-radius:50%;background:var(--acc);display:flex;align-items:center;justify-content:center;font-weight:800;font-size:0.85rem;color:#fff;flex-shrink:0}
.user-info{flex:1;min-width:0}
.user-name{font-weight:700;font-size:0.85rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.user-email{font-size:0.72rem;color:var(--tx3);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.logout-btn{padding:3px 8px;border-radius:5px;background:transparent;border:1px solid var(--border);color:var(--tx3);font-size:0.72rem;cursor:pointer;font-family:var(--font)}
.logout-btn:hover{border-color:var(--acc-r);color:var(--acc-r)}

/* â”€â”€â”€ HEADER â”€â”€â”€ */
.app-header{background:var(--bg2);border-bottom:1px solid var(--border);padding:0 24px;display:flex;align-items:center;gap:12px;height:60px;flex-shrink:0}
.header-hamburger{width:36px;height:36px;border-radius:var(--radius-sm);background:transparent;border:1px solid var(--border);color:var(--tx2);display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1.1rem;transition:all 0.2s}
.header-hamburger:hover{background:var(--bg3);color:var(--tx)}
.header-title{font-family:var(--font-head);font-weight:800;font-size:1.15rem;flex:1}
.header-actions{display:flex;align-items:center;gap:8px}
.h-btn{width:36px;height:36px;border-radius:var(--radius-sm);background:transparent;border:1px solid var(--border);color:var(--tx2);display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1rem;transition:all 0.2s;position:relative;font-family:var(--font)}
.h-btn:hover{background:var(--bg3);color:var(--tx)}
.notif-badge{position:absolute;top:-3px;right:-3px;width:16px;height:16px;background:var(--acc-r);border-radius:50%;font-size:0.6rem;font-weight:700;display:flex;align-items:center;justify-content:center;color:#fff;display:none}
.notif-badge.show{display:flex}
.ai-toggle-btn{padding:0 16px;height:36px;border-radius:100px;background:linear-gradient(135deg,var(--acc),var(--acc-p));color:#fff;border:none;font-weight:700;font-size:0.8rem;cursor:pointer;display:flex;align-items:center;gap:6px;font-family:var(--font);transition:all 0.2s}
.ai-toggle-btn:hover{opacity:0.88}

/* â”€â”€â”€ MAIN CONTENT â”€â”€â”€ */
.app-main{display:flex;flex-direction:column;overflow:hidden;min-width:0}
.content-area{flex:1;overflow-y:auto;padding:28px;animation:pageIn 0.25s ease}

/* Page visibility */
.page{display:none}
.page.active{display:block;animation:pageIn 0.25s ease}

/* â”€â”€â”€ CARDS & UTILITIES â”€â”€â”€ */
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:20px;transition:all 0.2s}
.card:hover{border-color:var(--bg4)}
.section-title{font-family:var(--font-head);font-size:1.4rem;font-weight:800;margin-bottom:6px}
.section-sub{color:var(--tx3);font-size:0.875rem;margin-bottom:24px}
.pill{padding:3px 10px;border-radius:100px;font-size:0.72rem;font-weight:700;text-transform:uppercase;letter-spacing:0.5px}
.pill-high{background:rgba(245,91,91,0.12);color:var(--acc-r);border:1px solid rgba(245,91,91,0.2)}
.pill-medium{background:rgba(245,196,91,0.12);color:var(--acc-y);border:1px solid rgba(245,196,91,0.2)}
.pill-low{background:rgba(91,245,160,0.12);color:var(--acc-g);border:1px solid rgba(91,245,160,0.2)}
.pill-pending{background:rgba(107,114,152,0.15);color:var(--tx3);border:1px solid var(--border)}
.pill-in-progress{background:rgba(91,110,245,0.15);color:var(--acc);border:1px solid rgba(91,110,245,0.2)}
.pill-completed{background:rgba(91,245,160,0.12);color:var(--acc-g);border:1px solid rgba(91,245,160,0.2)}
.pill-overdue{background:rgba(245,91,91,0.12);color:var(--acc-r);border:1px solid rgba(245,91,91,0.2)}
.tag{display:inline-block}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
.btn{padding:8px 18px;border-radius:var(--radius-sm);font-weight:600;font-size:0.85rem;border:none;cursor:pointer;transition:all 0.2s;font-family:var(--font);display:inline-flex;align-items:center;gap:6px}
.btn-primary{background:var(--acc);color:#fff}
.btn-primary:hover{opacity:0.88;transform:translateY(-1px)}
.btn-ghost{background:transparent;color:var(--tx2);border:1px solid var(--border)}
.btn-ghost:hover{background:var(--bg3);color:var(--tx)}
.btn-danger{background:transparent;color:var(--acc-r);border:1px solid rgba(245,91,91,0.3)}
.btn-danger:hover{background:rgba(245,91,91,0.1)}
.empty-state{text-align:center;padding:60px 20px;color:var(--tx3)}
.empty-state .es-icon{font-size:3rem;margin-bottom:14px}
.empty-state .es-title{font-weight:700;font-size:1rem;margin-bottom:6px;color:var(--tx2)}
.empty-state .es-sub{font-size:0.875rem}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DASHBOARD PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.greeting{margin-bottom:28px}
.greeting h2{font-family:var(--font-head);font-size:1.8rem;font-weight:800;margin-bottom:4px}
.greeting .greeting-sub{color:var(--tx3);font-size:0.9rem}

.kpi-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:14px;margin-bottom:24px}
.kpi-card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:18px;position:relative;overflow:hidden;transition:all 0.2s}
.kpi-card:hover{border-color:var(--acc);transform:translateY(-2px);box-shadow:var(--shadow)}
.kpi-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
.kpi-card.k-total::before{background:var(--acc)}
.kpi-card.k-done::before{background:var(--acc-g)}
.kpi-card.k-pending::before{background:var(--acc-y)}
.kpi-card.k-progress::before{background:var(--acc-p)}
.kpi-card.k-high::before{background:var(--acc-r)}
.kpi-card.k-overdue::before{background:var(--acc-r)}
.kpi-icon{font-size:1.4rem;margin-bottom:8px}
.kpi-val{font-family:var(--font-head);font-size:2rem;font-weight:800;line-height:1}
.kpi-label{font-size:0.75rem;color:var(--tx3);margin-top:4px;font-weight:600}

.dash-grid{display:grid;grid-template-columns:1fr 300px;gap:20px;margin-bottom:24px}
.ring-section{display:flex;flex-direction:column;align-items:center;padding:24px;background:var(--card);border:1px solid var(--border);border-radius:var(--radius)}
.ring-title{font-weight:700;font-size:0.875rem;margin-bottom:16px;color:var(--tx2)}
.ring-wrap{position:relative;width:160px;height:160px}
.ring-svg{transform:rotate(-90deg)}
.ring-bg{fill:none;stroke:var(--bg4);stroke-width:14}
.ring-fg{fill:none;stroke:var(--acc-g);stroke-width:14;stroke-linecap:round;stroke-dasharray:251;stroke-dashoffset:251;transition:stroke-dashoffset 1.2s ease;animation:none}
.ring-pct{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
.ring-pct span{font-family:var(--font-head);font-size:2rem;font-weight:800;color:var(--tx)}
.ring-pct small{font-size:0.72rem;color:var(--tx3)}

.streak-section{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:20px}
.streak-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.streak-count{font-family:var(--font-head);font-size:1.8rem;font-weight:800;color:var(--acc-y)}
.streak-label{font-size:0.75rem;color:var(--tx3)}
.streak-dots{display:flex;gap:6px;flex-wrap:wrap}
.s-dot{width:32px;height:32px;border-radius:var(--radius-sm);background:var(--bg3);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:0.65rem;color:var(--tx4);flex-direction:column;font-weight:700}
.s-dot.active{background:rgba(245,196,91,0.15);border-color:var(--acc-y);color:var(--acc-y)}
.s-dot.today{background:rgba(245,196,91,0.25);border-color:var(--acc-y);box-shadow:0 0 8px rgba(245,196,91,0.3);color:var(--acc-y)}

.chart-card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:20px}
.chart-title{font-weight:700;font-size:0.9rem;margin-bottom:16px;color:var(--tx2)}
.chart-wrap{position:relative;height:220px}

.recent-list{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:20px}
.recent-item{display:flex;align-items:center;gap:12px;padding:10px 0;border-bottom:1px solid var(--border)}
.recent-item:last-child{border-bottom:none}
.ri-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.ri-info{flex:1;min-width:0}
.ri-title{font-size:0.875rem;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.ri-sub{font-size:0.75rem;color:var(--tx3)}
.ri-status{flex-shrink:0}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TASKS PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.tasks-toolbar{display:flex;align-items:center;gap:10px;margin-bottom:20px;flex-wrap:wrap}
.search-box{flex:1;min-width:180px;position:relative}
.search-box input{width:100%;padding:10px 14px 10px 38px;background:var(--bg3);border:1.5px solid var(--border);border-radius:var(--radius-sm);color:var(--tx);font-size:0.875rem;outline:none;font-family:var(--font);transition:all 0.2s}
.search-box input:focus{border-color:var(--acc)}
.search-box::before{content:'ğŸ”';position:absolute;left:12px;top:50%;transform:translateY(-50%);font-size:0.85rem;pointer-events:none}
.filter-chips{display:flex;gap:6px;flex-wrap:wrap}
.fc{padding:7px 14px;border-radius:100px;font-size:0.78rem;font-weight:600;cursor:pointer;border:1.5px solid var(--border);background:var(--bg3);color:var(--tx3);transition:all 0.2s;font-family:var(--font)}
.fc.active,.fc:hover{border-color:var(--acc);color:var(--acc);background:rgba(91,110,245,0.1)}
.tasks-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px}
.task-card{background:var(--card);border:1.5px solid var(--border);border-radius:var(--radius);padding:18px;position:relative;transition:all 0.2s;border-top:3px solid var(--border)}
.task-card:hover{box-shadow:var(--shadow);transform:translateY(-2px)}
.task-card.tc-high{border-top-color:var(--acc-r)}
.task-card.tc-medium{border-top-color:var(--acc-y)}
.task-card.tc-low{border-top-color:var(--acc-g)}
.task-card.tc-overdue{box-shadow:0 0 0 1px rgba(245,91,91,0.2)}
.tc-header{display:flex;align-items:flex-start;justify-content:space-between;gap:8px;margin-bottom:8px}
.tc-title{font-weight:700;font-size:0.95rem;line-height:1.3;flex:1}
.tc-title.completed-title{text-decoration:line-through;opacity:0.5}
.tc-actions{display:flex;gap:4px;flex-shrink:0}
.icon-btn{width:28px;height:28px;border-radius:6px;background:transparent;border:1px solid var(--border);color:var(--tx3);display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:0.85rem;transition:all 0.2s}
.icon-btn:hover{background:var(--bg3);color:var(--tx)}
.icon-btn.complete-btn:hover{color:var(--acc-g);border-color:var(--acc-g)}
.icon-btn.delete-btn:hover{color:var(--acc-r);border-color:var(--acc-r)}
.tc-meta{display:flex;align-items:center;gap:6px;flex-wrap:wrap;margin:8px 0}
.tc-subject{font-size:0.78rem;color:var(--tx3)}
.tc-due{font-size:0.78rem;color:var(--tx3)}
.tc-due.overdue{color:var(--acc-r);font-weight:600}
.tc-desc{font-size:0.8rem;color:var(--tx3);margin-top:5px;line-height:1.6;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;white-space:normal;word-break:break-word}
.subtasks-wrap{margin-top:12px;border-top:1px solid var(--border);padding-top:10px}
.subtask-item{display:flex;align-items:center;gap:8px;padding:4px 0;cursor:pointer}
.subtask-cb{width:14px;height:14px;border-radius:3px;border:1.5px solid var(--border);background:transparent;flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all 0.2s}
.subtask-cb.checked{background:var(--acc-g);border-color:var(--acc-g);color:#000;font-size:0.6rem}
.subtask-txt{font-size:0.78rem;color:var(--tx2)}
.subtask-txt.checked{text-decoration:line-through;opacity:0.5}
.tc-footer{margin-top:12px;padding-top:10px;border-top:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.ai-subtask-btn{padding:4px 10px;border-radius:100px;background:rgba(196,91,245,0.1);border:1px solid rgba(196,91,245,0.2);color:var(--acc-p);font-size:0.72rem;font-weight:700;cursor:pointer;font-family:var(--font);transition:all 0.2s}
.ai-subtask-btn:hover{background:rgba(196,91,245,0.2)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ADD TASK PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.add-form{max-width:620px}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.form-select{width:100%;padding:11px 14px;background:var(--bg3);border:1.5px solid var(--border);border-radius:var(--radius-sm);color:var(--tx);font-size:0.9rem;outline:none;cursor:pointer;font-family:var(--font);transition:all 0.2s;-webkit-appearance:none}
.form-select:focus{border-color:var(--acc)}
.form-select option{background:var(--bg3);color:var(--tx)}
.form-textarea{width:100%;padding:11px 14px;background:var(--bg3);border:1.5px solid var(--border);border-radius:var(--radius-sm);color:var(--tx);font-size:0.9rem;outline:none;resize:vertical;min-height:90px;font-family:var(--font);transition:all 0.2s}
.form-textarea:focus{border-color:var(--acc)}
.ai-priority-row{display:flex;align-items:center;gap:10px;margin-top:4px}
.ai-prio-btn{padding:8px 16px;border-radius:100px;background:rgba(196,91,245,0.1);border:1px solid rgba(196,91,245,0.25);color:var(--acc-p);font-size:0.8rem;font-weight:700;cursor:pointer;font-family:var(--font);transition:all 0.2s}
.ai-prio-btn:hover{background:rgba(196,91,245,0.2)}
.ai-prio-result{font-size:0.78rem;color:var(--acc-p);display:none}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UPCOMING PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.timeline{position:relative;padding-left:28px}
.timeline::before{content:'';position:absolute;left:8px;top:0;bottom:0;width:2px;background:var(--border)}
.tl-item{position:relative;margin-bottom:16px}
.tl-dot{position:absolute;left:-24px;top:4px;width:16px;height:16px;border-radius:50%;background:var(--card);border:3px solid var(--acc);flex-shrink:0}
.tl-dot.overdue{border-color:var(--acc-r)}
.tl-dot.today{border-color:var(--acc-g);box-shadow:0 0 8px rgba(91,245,160,0.4)}
.tl-content{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:14px 16px}
.tl-date{font-size:0.72rem;font-weight:700;color:var(--tx3);letter-spacing:0.5px;text-transform:uppercase;margin-bottom:6px}
.tl-title{font-weight:700;margin-bottom:4px}
.tl-meta{display:flex;gap:8px;align-items:center}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PERFORMANCE PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.perf-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:14px;margin-bottom:24px}
.perf-stat{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:20px;text-align:center}
.perf-val{font-family:var(--font-head);font-size:2.2rem;font-weight:800;color:var(--acc)}
.perf-label{font-size:0.78rem;color:var(--tx3);margin-top:4px}
.subject-bars{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:20px;margin-bottom:20px}
.subject-bar-item{margin-bottom:14px}
.sb-header{display:flex;justify-content:space-between;font-size:0.8rem;font-weight:600;margin-bottom:5px}
.sb-track{height:8px;background:var(--bg4);border-radius:4px;overflow:hidden}
.sb-fill{height:100%;border-radius:4px;background:var(--acc);transition:width 1s ease}

.heatmap-section{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:20px;margin-bottom:20px}
.heatmap-grid{display:grid;grid-template-columns:repeat(28,1fr);gap:3px;margin-top:14px}
.hm-cell{aspect-ratio:1;border-radius:3px;background:var(--bg4);transition:all 0.15s;animation:heatIn 0.3s ease both}
.hm-cell:hover{transform:scale(1.2)}
.hm-0{background:var(--bg4);opacity:0.4}
.hm-1{background:rgba(91,110,245,0.25)}
.hm-2{background:rgba(91,110,245,0.5)}
.hm-3{background:var(--acc)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AI PANEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.ai-panel{background:var(--bg2);border-left:1px solid var(--border);display:flex;flex-direction:column;overflow:hidden;transition:all 0.3s}
.ai-header{padding:16px 18px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px;flex-shrink:0}
.ai-avatar{width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,var(--acc),var(--acc-p));display:flex;align-items:center;justify-content:center;font-size:1rem;flex-shrink:0}
.ai-info{flex:1}
.ai-name{font-weight:800;font-size:0.875rem}
.ai-status{font-size:0.72rem;color:var(--acc-g);display:flex;align-items:center;gap:4px}
.ai-status::before{content:'';width:6px;height:6px;border-radius:50%;background:var(--acc-g);animation:bounce 2s infinite}
.ai-close-btn{width:28px;height:28px;border-radius:6px;background:transparent;border:1px solid var(--border);color:var(--tx3);cursor:pointer;display:flex;align-items:center;justify-content:center}
.ai-close-btn:hover{color:var(--acc-r);border-color:var(--acc-r)}
.ai-messages{flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:12px}
.msg{display:flex;flex-direction:column;max-width:88%;animation:fadeIn 0.25s ease}
.msg.user{align-self:flex-end;align-items:flex-end}
.msg.bot{align-self:flex-start;align-items:flex-start}
.msg-bubble{padding:10px 14px;border-radius:14px;font-size:0.85rem;line-height:1.55}
.msg.user .msg-bubble{background:var(--acc);color:#fff;border-radius:14px 14px 4px 14px}
.msg.bot .msg-bubble{background:var(--bg3);color:var(--tx);border-radius:14px 14px 14px 4px}
.msg-time{font-size:0.65rem;color:var(--tx4);margin-top:3px;padding:0 4px}
.typing-indicator{display:flex;gap:5px;align-items:center;padding:12px 14px;background:var(--bg3);border-radius:14px 14px 14px 4px;display:none}
.typing-dot{width:7px;height:7px;border-radius:50%;background:var(--tx3);animation:dot 1.2s infinite}
.typing-dot:nth-child(2){animation-delay:0.2s}
.typing-dot:nth-child(3){animation-delay:0.4s}
.ai-chips{padding:10px 16px;display:flex;gap:6px;flex-wrap:wrap;border-top:1px solid var(--border);flex-shrink:0}
.ai-chip{padding:5px 10px;border-radius:100px;background:var(--bg3);border:1px solid var(--border);font-size:0.75rem;color:var(--tx2);cursor:pointer;transition:all 0.2s;font-family:var(--font)}
.ai-chip:hover{border-color:var(--acc);color:var(--acc)}
.ai-input-row{padding:12px 16px;border-top:1px solid var(--border);display:flex;gap:8px;flex-shrink:0}
.ai-input{flex:1;padding:10px 14px;background:var(--bg3);border:1.5px solid var(--border);border-radius:100px;color:var(--tx);font-size:0.85rem;outline:none;font-family:var(--font);transition:all 0.2s}
.ai-input:focus{border-color:var(--acc)}
.ai-send-btn{width:38px;height:38px;border-radius:50%;background:var(--acc);border:none;color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:0.9rem;flex-shrink:0;transition:all 0.2s}
.ai-send-btn:hover{opacity:0.88;transform:scale(1.05)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NOTIFICATIONS PANEL (DROPDOWN)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.notif-panel{position:absolute;top:56px;right:16px;width:320px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);z-index:100;display:none;animation:fadeIn 0.2s ease}
.notif-panel.show{display:block}
.np-header{padding:14px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.np-title{font-weight:700;font-size:0.9rem}
.np-clear{font-size:0.75rem;color:var(--tx3);cursor:pointer;transition:color 0.2s}
.np-clear:hover{color:var(--acc-r)}
.np-list{max-height:300px;overflow-y:auto}
.np-item{padding:12px 16px;border-bottom:1px solid var(--border);cursor:pointer;transition:background 0.15s}
.np-item:hover{background:var(--bg3)}
.np-item:last-child{border-bottom:none}
.np-item-title{font-size:0.83rem;font-weight:600;margin-bottom:2px}
.np-item-sub{font-size:0.75rem;color:var(--tx3)}
.np-item.unread{background:rgba(91,110,245,0.05)}
.np-empty{padding:28px;text-align:center;color:var(--tx3);font-size:0.85rem}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.7);z-index:200;display:none;align-items:center;justify-content:center;padding:20px;backdrop-filter:blur(4px)}
.modal-overlay.show{display:flex}
.modal{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius-lg);padding:28px;width:100%;max-width:520px;max-height:90vh;overflow-y:auto;animation:fadeIn 0.25s ease}
.modal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:24px}
.modal-title{font-family:var(--font-head);font-size:1.2rem;font-weight:800}
.modal-close{width:32px;height:32px;border-radius:var(--radius-sm);background:var(--bg3);border:1px solid var(--border);color:var(--tx3);cursor:pointer;font-size:1rem;display:flex;align-items:center;justify-content:center;transition:all 0.2s;font-family:var(--font)}
.modal-close:hover{color:var(--acc-r);border-color:var(--acc-r)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   THEME PICKER PANEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.theme-panel{position:absolute;top:56px;right:56px;width:260px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);z-index:100;display:none;padding:16px;animation:fadeIn 0.2s ease}
.theme-panel.show{display:block}
.tp-label{font-size:0.65rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--tx4);margin-bottom:8px}
.tp-colors{display:grid;grid-template-columns:repeat(6,1fr);gap:6px;margin-bottom:16px}
.tp-color{width:32px;height:32px;border-radius:50%;cursor:pointer;border:3px solid transparent;transition:all 0.2s;position:relative}
.tp-color.active{border-color:var(--tx)}
.tp-color:hover{transform:scale(1.15)}
.tp-fonts{display:flex;flex-direction:column;gap:4px}
.tp-font-btn{padding:7px 10px;border-radius:var(--radius-sm);background:var(--bg3);border:1px solid var(--border);color:var(--tx2);font-size:0.8rem;cursor:pointer;text-align:left;transition:all 0.2s;font-family:var(--font)}
.tp-font-btn.active{border-color:var(--acc);color:var(--acc);background:rgba(91,110,245,0.08)}


/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#toastContainer{position:fixed;bottom:24px;right:24px;z-index:500;display:flex;flex-direction:column;gap:8px;pointer-events:none}
.toast{padding:12px 18px;border-radius:var(--radius-sm);font-size:0.85rem;font-weight:600;color:#fff;min-width:200px;max-width:320px;animation:toastIn 0.3s ease;box-shadow:var(--shadow);pointer-events:all;display:flex;align-items:center;gap:8px;border:1px solid rgba(255,255,255,0.1)}
.toast.success{background:rgba(91,245,160,0.15);color:var(--acc-g);border-color:rgba(91,245,160,0.2)}
.toast.error{background:rgba(245,91,91,0.15);color:var(--acc-r);border-color:rgba(245,91,91,0.2)}
.toast.info{background:rgba(91,110,245,0.15);color:var(--acc2);border-color:rgba(91,110,245,0.2)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOTTOM NAV (mobile)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.bottom-nav{display:none;position:fixed;bottom:0;left:0;right:0;background:var(--bg2);border-top:1px solid var(--border);z-index:50;padding:8px 0 env(safe-area-inset-bottom,8px)}
.bn-items{display:flex;justify-content:space-around}
.bn-item{display:flex;flex-direction:column;align-items:center;gap:3px;padding:6px 12px;color:var(--tx3);font-size:0.65rem;font-weight:600;cursor:pointer;border-radius:var(--radius-sm);transition:color 0.2s;border:none;background:transparent;font-family:var(--font)}
.bn-item.active,.bn-item:hover{color:var(--acc)}
.bn-icon{font-size:1.15rem}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media(max-width:1199px){
  #mainApp{grid-template-columns:230px 1fr!important}
  .ai-panel{position:fixed;right:-100%;top:0;bottom:0;width:340px;z-index:150;transition:right 0.3s;box-shadow:var(--shadow)}
  #mainApp.ai-open .ai-panel{right:0}
}
@media(max-width:900px){
  .dash-grid{grid-template-columns:1fr}
  .form-row{grid-template-columns:1fr}
}
@media(max-width:767px){
  #mainApp{grid-template-columns:1fr!important}
  .sidebar{position:fixed;left:-100%;top:0;bottom:0;z-index:150;transition:left 0.3s;width:248px;box-shadow:var(--shadow)}
  .sidebar.open{left:0}
  .bottom-nav{display:block}
  .content-area{padding:16px;padding-bottom:80px}
  .landing-header{padding:16px 20px}
  .hero{padding:60px 20px 48px}
  .hero-title{font-size:2.2rem}
  .landing-nav a:not(.btn-cta){display:none}
  .features{padding:48px 20px;grid-template-columns:1fr}
  .landing-cta-sec{padding:40px 20px}
  .landing-footer{padding:16px 20px;flex-direction:column;gap:8px;text-align:center}
  .kpi-grid{grid-template-columns:repeat(2,1fr)}
  .auth-box{padding:28px 20px}
  .tasks-toolbar{flex-direction:column;align-items:stretch}
}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â• LANDING PAGE â•â•â•â•â•â•â•â•â•â•â• -->
<div id="landingPage">
  <header class="landing-header">
    <div class="landing-logo"><span class="logo-dot"></span>StudyBot</div>
    <nav class="landing-nav">
      <a href="#features">Features</a>
      <a href="#how">How it works</a>
      <button class="btn-cta" onclick="showAuth()">Get Started â†’</button>
    </nav>
  </header>

  <section class="hero">
    <div class="hero-badge">ğŸ¤– AI-Powered Study Assistant</div>
    <h1 class="hero-title">Study smarter,<br>not <span>harder</span></h1>
    <p class="hero-sub">StudyBot uses AI to help you manage assignments, prioritise tasks, and track your academic performance â€” all in one place.</p>
    <div class="hero-btns">
      <button class="btn-hero primary" onclick="showAuth()">Start for free â†’</button>
      <button class="btn-hero secondary" onclick="document.getElementById('features').scrollIntoView({behavior:'smooth'})">See features</button>
    </div>
  </section>

  <section class="features" id="features">
    <div class="feature-card"><div class="feature-icon">ğŸ“‹</div><div class="feature-title">Smart Task Management</div><div class="feature-desc">Create, organise, and track tasks with priorities, deadlines, and subjects. Filter and search instantly.</div></div>
    <div class="feature-card"><div class="feature-icon">ğŸ¤–</div><div class="feature-title">AI Study Assistant</div><div class="feature-desc">Chat with StudyBot AI for study plans, focus suggestions, and instant help. Powered by advanced LLM.</div></div>
    <div class="feature-card"><div class="feature-icon">ğŸ“Š</div><div class="feature-title">Performance Analytics</div><div class="feature-desc">Track your completion rates, study streaks, and subject performance with beautiful charts.</div></div>
    <div class="feature-card"><div class="feature-icon">ğŸ””</div><div class="feature-title">Smart Notifications</div><div class="feature-desc">Get alerted about overdue tasks, tasks due today, and upcoming deadlines automatically.</div></div>
    <div class="feature-card"><div class="feature-icon">ğŸ¨</div><div class="feature-title">6 Themes + 4 Fonts</div><div class="feature-desc">Personalise StudyBot with 6 colour themes and 4 font families. Your preferences are saved automatically.</div></div>
    <div class="feature-card"><div class="feature-icon">ğŸ“±</div><div class="feature-title">Works Everywhere</div><div class="feature-desc">Fully responsive design optimised for mobile, tablet, and desktop with a native-like mobile experience.</div></div>
  </section>

  <section class="landing-cta-sec" id="how">
    <h2>Ready to ace your studies?</h2>
    <p>Join students using StudyBot to stay on top of their assignments and reach their academic goals.</p>
    <button class="btn-hero primary" onclick="showAuth()">Create free account â†’</button>
  </section>

  <footer class="landing-footer">
    <span>Â© 2026 StudyBot â€” Built for students, by students</span>
    <span>HTML5 Â· CSS3 Â· Vanilla JS</span>
  </footer>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â• AUTH PAGE â•â•â•â•â•â•â•â•â•â•â• -->
<div id="authPage" style="display:none">
  <div class="auth-box">
    <div class="auth-logo">ğŸ¤– StudyBot</div>
    <div class="auth-sub">Your AI-powered study companion</div>
    <div class="auth-tabs">
      <button class="auth-tab active" id="loginTab" onclick="switchAuthTab('login')">Sign In</button>
      <button class="auth-tab" id="registerTab" onclick="switchAuthTab('register')">Register</button>
    </div>

    <!-- LOGIN FORM -->
    <div id="loginForm">
      <div class="form-group">
        <label for="loginEmail">Email address</label>
        <input type="email" id="loginEmail" class="form-input" placeholder="you@example.com" required autocomplete="email"/>
        <div class="form-error" id="loginEmailErr">Please enter a valid email.</div>
      </div>
      <div class="form-group">
        <label for="loginPass">Password</label>
        <input type="password" id="loginPass" class="form-input" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required autocomplete="current-password"/>
        <div class="form-error" id="loginPassErr">Password is required.</div>
      </div>
      <button class="btn-submit" onclick="handleLogin()">Sign In â†’</button>
      <div id="quickLogins" style="display:none">
        <div class="quick-logins">
          <div class="ql-label">Quick login</div>
          <div class="ql-chips" id="qlChips"></div>
        </div>
      </div>
    </div>

    <!-- REGISTER FORM -->
    <div id="registerForm" style="display:none">
      <div class="form-group">
        <label for="regName">Full name</label>
        <input type="text" id="regName" class="form-input" placeholder="Your name" required/>
        <div class="form-error" id="regNameErr">Name is required.</div>
      </div>
      <div class="form-group">
        <label for="regEmail">Email address</label>
        <input type="email" id="regEmail" class="form-input" placeholder="you@example.com" required autocomplete="email"/>
        <div class="form-error" id="regEmailErr">Please enter a valid email.</div>
      </div>
      <div class="form-group">
        <label for="regPass">Password</label>
        <input type="password" id="regPass" class="form-input" placeholder="Min 4 characters" required autocomplete="new-password"/>
        <div class="form-error" id="regPassErr">Password must be at least 4 characters.</div>
      </div>
      <button class="btn-submit" onclick="handleRegister()">Create Account â†’</button>
    </div>

    <div class="back-to-landing"><a href="#" onclick="showLanding()">â† Back to home</a></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â• MAIN APP â•â•â•â•â•â•â•â•â•â•â• -->
<div id="mainApp">

  <!-- SIDEBAR -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-top">
      <div class="sidebar-logo"><span class="logo-dot"></span>StudyBot</div>
      <div class="nav-section">
        <div class="nav-label">Menu</div>
        <button class="nav-item active" data-page="dashboard" onclick="navigate('dashboard')"><span class="nav-icon">ğŸ“Š</span>Dashboard</button>
        <button class="nav-item" data-page="tasks" onclick="navigate('tasks')"><span class="nav-icon">ğŸ“‹</span>My Tasks</button>
        <button class="nav-item" data-page="upcoming" onclick="navigate('upcoming')"><span class="nav-icon">ğŸ“…</span>Upcoming</button>
        <button class="nav-item" data-page="performance" onclick="navigate('performance')"><span class="nav-icon">ğŸ“ˆ</span>Performance</button>
        <button class="nav-item" data-page="add" onclick="navigate('add')"><span class="nav-icon">â•</span>Add Task</button>
      </div>
    </div>
    <div class="sidebar-bottom">
      <div class="user-chip">
        <div class="user-av" id="sidebarAv">?</div>
        <div class="user-info">
          <div class="user-name" id="sidebarName">Loading...</div>
          <div class="user-email" id="sidebarEmail">...</div>
        </div>
        <button class="logout-btn" onclick="handleLogout()">Out</button>
      </div>
    </div>
  </aside>

  <!-- MAIN COLUMN -->
  <div class="app-main">
    <header class="app-header">
      <button class="header-hamburger" onclick="toggleSidebar()" aria-label="Toggle sidebar">â˜°</button>
      <div class="header-title" id="headerTitle">Dashboard</div>
      <div class="header-actions">
        <div style="position:relative">
          <button class="h-btn" onclick="toggleNotifPanel()" aria-label="Notifications" id="notifBtn">ğŸ””<span class="notif-badge" id="notifBadge" aria-live="polite"></span></button>
          <div class="notif-panel" id="notifPanel">
            <div class="np-header"><span class="np-title">Notifications</span><span class="np-clear" onclick="clearNotifs()">Clear all</span></div>
            <div class="np-list" id="npList"></div>
          </div>
        </div>
        <div style="position:relative">
          <button class="h-btn" onclick="toggleThemePanel()" aria-label="Change theme" title="Themes & Fonts">ğŸ¨</button>
          <div class="theme-panel" id="themePanel">
            <div class="tp-label">Colour Theme</div>
            <div class="tp-colors">
              <div class="tp-color active" style="background:linear-gradient(135deg,#5b6ef5,#c45bf5)" data-theme="midnight" onclick="setTheme('midnight')" title="Midnight"></div>
              <div class="tp-color" style="background:linear-gradient(135deg,#00d4ff,#51fa8a)" data-theme="aurora" onclick="setTheme('aurora')" title="Aurora"></div>
              <div class="tp-color" style="background:linear-gradient(135deg,#f5a623,#f55b5b)" data-theme="solar" onclick="setTheme('solar')" title="Solar"></div>
              <div class="tp-color" style="background:linear-gradient(135deg,#2d5016,#6fa040)" data-theme="paper" onclick="setTheme('paper')" title="Paper"></div>
              <div class="tp-color" style="background:linear-gradient(135deg,#f56ab0,#c45bf5)" data-theme="rose" onclick="setTheme('rose')" title="Rose"></div>
              <div class="tp-color" style="background:linear-gradient(135deg,#42a5f5,#90caf9)" data-theme="slate" onclick="setTheme('slate')" title="Slate"></div>
              <!-- Add this 7th swatch after your existing 6 -->
<div class="tp-color" style="background:linear-gradient(135deg,#f6f8fc,#4f63ff)" data-theme="light" onclick="setTheme('light')" title="Light"></div>
<div class="tp-color" style="background:linear-gradient(135deg,#f0f7ff,#0066ff)" data-theme="sky"       onclick="setTheme('sky')"       title="Sky Blue"></div>
<div class="tp-color" style="background:linear-gradient(135deg,#f0fff8,#00b86e)" data-theme="mint"      onclick="setTheme('mint')"      title="Mint Green"></div>
<div class="tp-color" style="background:linear-gradient(135deg,#fff8f0,#ff7020)" data-theme="peach"     onclick="setTheme('peach')"     title="Peach"></div>
<div class="tp-color" style="background:linear-gradient(135deg,#f8f0ff,#8020ff)" data-theme="lavender"  onclick="setTheme('lavender')"  title="Lavender"></div>
<div class="tp-color" style="background:linear-gradient(135deg,#fffef0,#c8a800)" data-theme="lemon"     onclick="setTheme('lemon')"     title="Lemon"></div>
<div class="tp-color" style="background:linear-gradient(135deg,#fff0f5,#e8006a)" data-theme="blush"     onclick="setTheme('blush')"     title="Blush Pink"></div>
<div class="tp-color" style="background:linear-gradient(135deg,#f5f7fa,#4455ee)" data-theme="cloud"     onclick="setTheme('cloud')"     title="Cloud"></div>
            </div>
            <div class="tp-label">Font Family</div>
            <div class="tp-fonts">
              <button class="tp-font-btn active" data-font="grotesk" onclick="setFont('grotesk')" style="font-family:'Cabinet Grotesk',sans-serif">Cabinet Grotesk</button>
              <button class="tp-font-btn" data-font="playfair" onclick="setFont('playfair')" style="font-family:'Playfair Display',serif">Playfair Display</button>
              <button class="tp-font-btn" data-font="unbounded" onclick="setFont('unbounded')" style="font-family:'Unbounded',sans-serif">Unbounded</button>
              <button class="tp-font-btn" data-font="mono" onclick="setFont('mono')" style="font-family:'DM Mono',monospace">DM Mono</button>
              <button class="tp-font-btn" data-font="inter" onclick="setFont('inter')" style="font-family:'Inter',sans-serif">Inter</button>
<button class="tp-font-btn" data-font="space" onclick="setFont('space')" style="font-family:'Space Grotesk',sans-serif">Space Grotesk</button>
<button class="tp-font-btn" data-font="manrope" onclick="setFont('manrope')" style="font-family:'Manrope',sans-serif">Manrope</button>
<button class="tp-font-btn" data-font="orbitron" onclick="setFont('orbitron')" style="font-family:'Orbitron',sans-serif">Orbitron</button>
<button class="tp-font-btn" data-font="lora" onclick="setFont('lora')" style="font-family:'Lora',serif">Lora</button>
<button class="tp-font-btn" data-font="outfit"    onclick="setFont('outfit')"    style="font-family:'Outfit',sans-serif">Outfit</button>
<button class="tp-font-btn" data-font="jakarta"   onclick="setFont('jakarta')"   style="font-family:'Plus Jakarta Sans',sans-serif">Plus Jakarta Sans</button>
<button class="tp-font-btn" data-font="lexend"    onclick="setFont('lexend')"    style="font-family:'Lexend',sans-serif">Lexend</button>
<button class="tp-font-btn" data-font="nunito"    onclick="setFont('nunito')"    style="font-family:'Nunito',sans-serif">Nunito</button>
<button class="tp-font-btn" data-font="raleway"   onclick="setFont('raleway')"   style="font-family:'Raleway',sans-serif">Raleway</button>
<button class="tp-font-btn" data-font="josefin"   onclick="setFont('josefin')"   style="font-family:'Josefin Sans',sans-serif">Josefin Sans</button>
<button class="tp-font-btn" data-font="quicksand" onclick="setFont('quicksand')" style="font-family:'Quicksand',sans-serif">Quicksand</button>
<button class="tp-font-btn" data-font="righteous" onclick="setFont('righteous')" style="font-family:'Righteous',sans-serif">Righteous</button>
<button class="tp-font-btn" data-font="comfortaa" onclick="setFont('comfortaa')" style="font-family:'Comfortaa',sans-serif">Comfortaa</button>
            </div>
          </div>
        </div>
        <button class="ai-toggle-btn" onclick="toggleAI()">ğŸ¤– StudyBot AI</button>
      </div>
    </header>

    <div class="content-area">
      <!-- DASHBOARD -->
      <div class="page active" id="dashboardPage">
        <div class="greeting">
          <h2 id="greetingText">Good morning! ğŸ‘‹</h2>
          <div class="greeting-sub" id="greetingName">Welcome back â€” let's crush today's goals.</div>
        </div>
        <div class="kpi-grid" id="kpiGrid"></div>
        <div class="dash-grid">
          <div>
            <div class="card chart-card" style="margin-bottom:16px">
              <div class="chart-title">Task Distribution</div>
              <div class="chart-wrap"><canvas id="donutChart"></canvas></div>
            </div>
          </div>
          <div style="display:flex;flex-direction:column;gap:16px">
            <div class="ring-section">
              <div class="ring-title">Overall Progress</div>
              <div class="ring-wrap">
                <svg class="ring-svg" viewBox="0 0 90 90" width="160" height="160">
                  <circle class="ring-bg" cx="45" cy="45" r="40"/>
                  <circle class="ring-fg" cx="45" cy="45" r="40" id="ringFg"/>
                </svg>
                <div class="ring-pct"><span id="ringPct">0%</span><small>Complete</small></div>
              </div>
            </div>
            <div class="streak-section">
              <div class="streak-header">
                <div><div class="streak-count" id="streakCount">0</div><div class="streak-label">day streak ğŸ”¥</div></div>
              </div>
              <div class="streak-dots" id="streakDots"></div>
            </div>
          </div>
        </div>
        <div class="recent-list card" id="recentList">
          <div style="font-weight:700;font-size:0.9rem;margin-bottom:14px;color:var(--tx2)">Recent Activity</div>
        </div>
      </div>

      <!-- TASKS -->
      <div class="page" id="tasksPage">
        <div class="section-title">My Tasks</div>
        <div class="section-sub">Manage all your assignments and work items</div>
        <div class="tasks-toolbar">
          <div class="search-box"><input type="text" id="taskSearch" placeholder="Search tasks..." oninput="renderTasks()"/></div>
          <div class="filter-chips">
            <button class="fc active" data-filter="all" onclick="setFilter('all',this)">All</button>
            <button class="fc" data-filter="high" onclick="setFilter('high',this)">ğŸ”´ High</button>
            <button class="fc" data-filter="medium" onclick="setFilter('medium',this)">ğŸŸ¡ Medium</button>
            <button class="fc" data-filter="low" onclick="setFilter('low',this)">ğŸŸ¢ Low</button>
            <button class="fc" data-filter="completed" onclick="setFilter('completed',this)">âœ… Done</button>
          </div>
          <button class="btn btn-primary" onclick="navigate('add')">+ New Task</button>
        </div>
        <div class="tasks-grid" id="tasksGrid"></div>
      </div>

      <!-- UPCOMING -->
      <div class="page" id="upcomingPage">
        <div class="section-title">Upcoming Deadlines</div>
        <div class="section-sub">Tasks due in the next 14 days, sorted by date</div>
        <div class="timeline" id="upcomingTimeline"></div>
      </div>

      <!-- PERFORMANCE -->
      <div class="page" id="performancePage">
        <div class="section-title">Performance Analytics</div>
        <div class="section-sub">Track your study progress and patterns</div>
        <div class="perf-grid" id="perfGrid"></div>
        <div class="card subject-bars" id="subjectBars">
          <div class="chart-title" style="margin-bottom:12px">Subject Progress</div>
        </div>
        <div class="card heatmap-section">
          <div class="chart-title">28-Day Activity Heatmap</div>
          <div style="font-size:0.75rem;color:var(--tx3);margin-top:4px">Days you completed tasks</div>
          <div class="heatmap-grid" id="heatmap"></div>
        </div>
        <div class="card chart-card" style="margin-top:20px">
          <div class="chart-title">Weekly Completions</div>
          <div class="chart-wrap"><canvas id="barChart"></canvas></div>
        </div>
      </div>

      <!-- ADD TASK -->
      <div class="page" id="addPage">
        <div class="section-title">Add New Task</div>
        <div class="section-sub">Fill in the details for your new assignment</div>
        <div class="add-form">
          <div class="form-group">
            <label for="taskTitle">Task Title *</label>
            <input type="text" id="taskTitle" class="form-input" placeholder="e.g. Complete Math Assignment" required/>
            <div class="form-error" id="taskTitleErr">Title is required.</div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="taskSubject">Subject</label>
              <input type="text" id="taskSubject" class="form-input" placeholder="e.g. Mathematics"/>
            </div>
            <div class="form-group">
              <label for="taskDue">Due Date</label>
              <input type="date" id="taskDue" class="form-input"/>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="taskPriority">Priority</label>
              <select id="taskPriority" class="form-select">
                <option value="medium">Medium</option>
                <option value="high">High</option>
                <option value="low">Low</option>
              </select>
              <div class="ai-priority-row">
                <button class="ai-prio-btn" onclick="aiSuggestPriority()">âœ¨ AI Suggest Priority</button>
                <span class="ai-prio-result" id="aiPrioResult"></span>
              </div>
            </div>
            <div class="form-group">
              <label for="taskStatus">Status</label>
              <select id="taskStatus" class="form-select">
                <option value="pending">Pending</option>
                <option value="in-progress">In Progress</option>
                <option value="completed">Completed</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="taskNotes">Notes</label>
            <textarea id="taskNotes" class="form-textarea" placeholder="Additional details, references, or notes..."></textarea>
          </div>
          <div style="display:flex;gap:12px;margin-top:8px">
            <button class="btn btn-primary" onclick="submitTask()">Add Task â†’</button>
            <button class="btn btn-ghost" onclick="resetTaskForm()">Reset</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- AI PANEL -->
  <aside class="ai-panel" id="aiPanel" role="complementary" aria-label="AI Assistant">
    <div class="ai-header">
      <div class="ai-avatar">ğŸ¤–</div>
      <div class="ai-info">
        <div class="ai-name">StudyBot AI</div>
        <div class="ai-status">Online</div>
      </div>
      <button class="ai-close-btn" onclick="toggleAI()" aria-label="Close AI panel">âœ•</button>
    </div>
    <div class="ai-messages" id="aiMessages">
      <div class="msg bot">
        <div class="msg-bubble">ğŸ‘‹ Hi! I'm StudyBot AI. I can help you plan your study sessions, suggest priorities, generate task subtasks, or answer any questions. What do you need help with?</div>
        <div class="msg-time">Now</div>
      </div>
      <div class="typing-indicator" id="typingIndicator">
        <div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>
      </div>
    </div>
    <div class="ai-chips">
      <button class="ai-chip" onclick="sendChip('What should I focus on today?')">ğŸ¯ Focus today</button>
      <button class="ai-chip" onclick="sendChip('Am I overloaded this week?')">ğŸ“Š Workload check</button>
      <button class="ai-chip" onclick="sendChip('Make me a study plan')">ğŸ“… Study plan</button>
      <button class="ai-chip" onclick="sendChip('Show high priority tasks')">ğŸ”´ High priority</button>
    </div>
    <div class="ai-input-row">
      <input class="ai-input" id="aiInput" type="text" placeholder="Ask StudyBot..." aria-label="AI chat input"
        onkeydown="if(event.key==='Enter')sendAIMessage()"/>
      <button class="ai-send-btn" onclick="sendAIMessage()" aria-label="Send message">â¤</button>
    </div>
  </aside>
</div>

<!-- BOTTOM NAV -->
<nav class="bottom-nav" aria-label="Mobile navigation">
  <div class="bn-items">
    <button class="bn-item active" data-page="dashboard" onclick="navigate('dashboard')"><span class="bn-icon">ğŸ“Š</span>Dash</button>
    <button class="bn-item" data-page="tasks" onclick="navigate('tasks')"><span class="bn-icon">ğŸ“‹</span>Tasks</button>
    <button class="bn-item" data-page="upcoming" onclick="navigate('upcoming')"><span class="bn-icon">ğŸ“…</span>Soon</button>
    <button class="bn-item" data-page="performance" onclick="navigate('performance')"><span class="bn-icon">ğŸ“ˆ</span>Stats</button>
    <button class="bn-item" data-page="add" onclick="navigate('add')"><span class="bn-icon">â•</span>Add</button>
    <button class="bn-item" onclick="toggleAI()"><span class="bn-icon">ğŸ¤–</span>AI</button>
  </div>
</nav>

<!-- EDIT MODAL -->
<div class="modal-overlay" id="editModal" role="dialog" aria-modal="true" aria-labelledby="editModalTitle">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title" id="editModalTitle">Edit Task</div>
      <button class="modal-close" onclick="closeModal('editModal')" aria-label="Close modal">âœ•</button>
    </div>
    <div class="form-group"><label>Title *</label><input type="text" id="editTitle" class="form-input"/></div>
    <div class="form-row">
      <div class="form-group"><label>Subject</label><input type="text" id="editSubject" class="form-input"/></div>
      <div class="form-group"><label>Due Date</label><input type="date" id="editDue" class="form-input"/></div>
    </div>
    <div class="form-row">
      <div class="form-group"><label>Priority</label>
        <select id="editPriority" class="form-select"><option value="high">High</option><option value="medium">Medium</option><option value="low">Low</option></select>
      </div>
      <div class="form-group"><label>Status</label>
        <select id="editStatus" class="form-select"><option value="pending">Pending</option><option value="in-progress">In Progress</option><option value="completed">Completed</option></select>
      </div>
    </div>
    <div class="form-group"><label>Notes</label><textarea id="editNotes" class="form-textarea"></textarea></div>
    <div style="display:flex;gap:10px;margin-top:8px">
      <button class="btn btn-primary" onclick="saveEdit()">Save Changes</button>
      <button class="btn btn-ghost" onclick="closeModal('editModal')">Cancel</button>
    </div>
  </div>
</div>

<!-- TOAST CONTAINER -->
<div id="toastContainer" aria-live="polite"></div>

<!-- SIDEBAR OVERLAY (mobile) -->
<div id="sidebarOverlay" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:140" onclick="closeSidebar()"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â• JAVASCRIPT â•â•â•â•â•â•â•â•â•â•â• -->
<script>
/* â”€â”€â”€ STATE â”€â”€â”€ */
let currentUser = null;
let tasks = [];
let notifications = [];
let chatHistory = [];
let currentFilter = 'all';
let editingTaskId = null;
let donutChart = null;
let barChart = null;
let aiOpen = false;
let sidebarOpen = true;
const GROQ_API_KEY = '';  // Set your API key here or use the server endpoint

/* â”€â”€â”€ STORAGE HELPERS â”€â”€â”€ */
const get = (k) => { try { return JSON.parse(localStorage.getItem(k)); } catch { return null; } };
const set = (k, v) => localStorage.setItem(k, JSON.stringify(v));
const escHtml = (s) => String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');

/* â”€â”€â”€ INIT â”€â”€â”€ */
window.addEventListener('DOMContentLoaded', () => {
  const pref = get('studybot_prefs') || {};
  if (pref.theme) document.documentElement.setAttribute('data-theme', pref.theme);
  if (pref.font) document.documentElement.setAttribute('data-font', pref.font);
  updateThemeUI();

  const session = get('studybot_session');
  if (session) {
    currentUser = session;
    initApp();
  }
});

/* â”€â”€â”€ THEME SYSTEM â”€â”€â”€ */
function setTheme(t) {
  document.documentElement.setAttribute('data-theme', t);
  const p = get('studybot_prefs') || {};
  p.theme = t;
  set('studybot_prefs', p);
  updateThemeUI();
  if (donutChart) rebuildCharts();
}
function setFont(f) {
  document.documentElement.setAttribute('data-font', f);
  const p = get('studybot_prefs') || {};
  p.font = f;
  set('studybot_prefs', p);
  document.querySelectorAll('.tp-font-btn').forEach(b => b.classList.toggle('active', b.dataset.font === f));
}
function updateThemeUI() {
  const t = document.documentElement.getAttribute('data-theme') || 'midnight';
  const f = document.documentElement.getAttribute('data-font') || 'grotesk';
  document.querySelectorAll('.tp-color').forEach(c => c.classList.toggle('active', c.dataset.theme === t));
  document.querySelectorAll('.tp-font-btn').forEach(b => b.classList.toggle('active', b.dataset.font === f));
}
function toggleThemePanel() {
  document.getElementById('themePanel').classList.toggle('show');
  document.getElementById('notifPanel').classList.remove('show');
}

/* â”€â”€â”€ AUTH â”€â”€â”€ */
function showLanding() {
  document.getElementById('landingPage').style.display = 'block';
  document.getElementById('authPage').style.display = 'none';
}
function showAuth() {
  document.getElementById('landingPage').style.display = 'none';
  document.getElementById('authPage').style.display = 'flex';
  renderQuickLogins();
}
function switchAuthTab(tab) {
  document.getElementById('loginTab').classList.toggle('active', tab === 'login');
  document.getElementById('registerTab').classList.toggle('active', tab === 'register');
  document.getElementById('loginForm').style.display = tab === 'login' ? 'block' : 'none';
  document.getElementById('registerForm').style.display = tab === 'register' ? 'block' : 'none';
}
function renderQuickLogins() {
  const users = get('studybot_users') || {};
  const emails = Object.keys(users);
  const ql = document.getElementById('quickLogins');
  const chips = document.getElementById('qlChips');
  if (emails.length) {
    ql.style.display = 'block';
    chips.innerHTML = emails.map(e => `<div class="ql-chip" onclick="quickLogin('${escHtml(e)}')">${escHtml(users[e].name)}</div>`).join('');
  }
}
function quickLogin(email) {
  document.getElementById('loginEmail').value = email;
  document.getElementById('loginPass').focus();
}
function handleRegister() {
  const name = document.getElementById('regName').value.trim();
  const email = document.getElementById('regEmail').value.trim();
  const pass = document.getElementById('regPass').value;
  let valid = true;
  if (!name) { showErr('regNameErr'); valid = false; } else hideErr('regNameErr');
  if (!email || !email.includes('@')) { showErr('regEmailErr'); valid = false; } else hideErr('regEmailErr');
  if (pass.length < 4) { showErr('regPassErr'); valid = false; } else hideErr('regPassErr');
  if (!valid) return;
  const users = get('studybot_users') || {};
  if (users[email]) { showErr('regEmailErr'); document.getElementById('regEmailErr').textContent = 'Email already registered.'; return; }
  users[email] = { name, email, pass: btoa(pass), created: Date.now() };
  set('studybot_users', users);
  toast('Account created! Sign in below.', 'success');
  switchAuthTab('login');
  document.getElementById('loginEmail').value = email;
}
function handleLogin() {
  const email = document.getElementById('loginEmail').value.trim();
  const pass = document.getElementById('loginPass').value;
  let valid = true;
  if (!email || !email.includes('@')) { showErr('loginEmailErr'); valid = false; } else hideErr('loginEmailErr');
  if (!pass) { showErr('loginPassErr'); valid = false; } else hideErr('loginPassErr');
  if (!valid) return;
  const users = get('studybot_users') || {};
  const user = users[email];
  if (!user || atob(user.pass) !== pass) {
    showErr('loginPassErr');
    document.getElementById('loginPassErr').textContent = 'Invalid email or password.';
    return;
  }
  currentUser = { name: user.name, email, loginTime: Date.now() };
  set('studybot_session', currentUser);
  initApp();
}
function handleLogout() {
  localStorage.removeItem('studybot_session');
  currentUser = null;
  document.getElementById('mainApp').classList.remove('app-visible');
  showLanding();
  toast('Signed out.', 'info');
}
function showErr(id) { document.getElementById(id).style.display = 'block'; }
function hideErr(id) { document.getElementById(id).style.display = 'none'; }

/* â”€â”€â”€ APP INIT â”€â”€â”€ */
function initApp() {
  document.getElementById('authPage').style.display = 'none';
  document.getElementById('landingPage').style.display = 'none';
  document.getElementById('mainApp').classList.add('app-visible');
  loadUserData();
  updateUserUI();
  updateGreeting();
  navigate('dashboard');
  checkNotifications();
  loadChatHistory();
}
function loadUserData() {
  const key = `tasks_${currentUser.email}`;
  tasks = get(key) || [];
}
function saveUserData() {
  set(`tasks_${currentUser.email}`, tasks);
}
function loadChatHistory() {
  chatHistory = get(`chat_${currentUser.email}`) || [];
  const msgs = document.getElementById('aiMessages');
  msgs.innerHTML = `<div class="msg bot"><div class="msg-bubble">ğŸ‘‹ Hi ${escHtml(currentUser.name)}! I'm StudyBot AI. I can help you plan your study sessions, suggest priorities, generate subtasks, or answer questions. What do you need?</div><div class="msg-time">Now</div></div><div class="typing-indicator" id="typingIndicator"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div>`;
  chatHistory.forEach(m => appendMessage(m.role, m.content, false));
}
function updateUserUI() {
  const initial = currentUser.name.charAt(0).toUpperCase();
  document.getElementById('sidebarAv').textContent = initial;
  document.getElementById('sidebarName').textContent = currentUser.name;
  document.getElementById('sidebarEmail').textContent = currentUser.email;
}
function updateGreeting() {
  const h = new Date().getHours();
  const g = h < 12 ? 'Good morning' : h < 17 ? 'Good afternoon' : 'Good evening';
  document.getElementById('greetingText').textContent = `${g}, ${currentUser.name}! ğŸ‘‹`;
  document.getElementById('greetingName').textContent = `Here's your study overview for today.`;
}

/* â”€â”€â”€ NAVIGATION â”€â”€â”€ */
function navigate(page) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.querySelectorAll('.bn-item').forEach(n => n.classList.remove('active'));
  document.getElementById(page + 'Page').classList.add('active');
  document.querySelectorAll(`[data-page="${page}"]`).forEach(el => el.classList.add('active'));
  const titles = { dashboard:'Dashboard', tasks:'My Tasks', upcoming:'Upcoming Deadlines', performance:'Performance', add:'Add Task' };
  document.getElementById('headerTitle').textContent = titles[page] || 'StudyBot';
  if (page === 'dashboard') renderDashboard();
  if (page === 'tasks') renderTasks();
  if (page === 'upcoming') renderUpcoming();
  if (page === 'performance') renderPerformance();
  if (window.innerWidth < 768) closeSidebar();
}

/* â”€â”€â”€ SIDEBAR â”€â”€â”€ */
function toggleSidebar() {
  const s = document.getElementById('sidebar');
  const o = document.getElementById('sidebarOverlay');
  if (window.innerWidth < 768) {
    s.classList.toggle('open');
    o.style.display = s.classList.contains('open') ? 'block' : 'none';
  } else {
    s.style.width = sidebarOpen ? '0' : '248px';
    s.style.overflow = sidebarOpen ? 'hidden' : 'visible';
    sidebarOpen = !sidebarOpen;
  }
}
function closeSidebar() {
  document.getElementById('sidebar').classList.remove('open');
  document.getElementById('sidebarOverlay').style.display = 'none';
}

/* â”€â”€â”€ AI PANEL â”€â”€â”€ */
function toggleAI() {
  aiOpen = !aiOpen;
  document.getElementById('mainApp').classList.toggle('ai-open', aiOpen);
}

/* â”€â”€â”€ TASKS CRUD â”€â”€â”€ */
function submitTask() {
  const title = document.getElementById('taskTitle').value.trim();
  if (!title) { showErr('taskTitleErr'); return; } hideErr('taskTitleErr');
  const task = {
    id: Date.now().toString(),
    title,
    subject: document.getElementById('taskSubject').value.trim(),
    due: document.getElementById('taskDue').value,
    priority: document.getElementById('taskPriority').value,
    status: document.getElementById('taskStatus').value,
    notes: document.getElementById('taskNotes').value.trim(),
    subtasks: [],
    created_at: Date.now(),
    updated_at: Date.now()
  };
  tasks.unshift(task);
  saveUserData();
  toast('Task added!', 'success');
  addNotification(`New task: "${title}"`, 'info');
  resetTaskForm();
  navigate('tasks');
}
function resetTaskForm() {
  ['taskTitle','taskSubject','taskDue','taskNotes'].forEach(id => document.getElementById(id).value = '');
  document.getElementById('taskPriority').value = 'medium';
  document.getElementById('taskStatus').value = 'pending';
  document.getElementById('aiPrioResult').style.display = 'none';
}
function deleteTask(id) {
  if (!confirm('Delete this task?')) return;
  tasks = tasks.filter(t => t.id !== id);
  saveUserData();
  toast('Task deleted.', 'info');
  renderTasks();
}
function toggleComplete(id) {
  const t = tasks.find(t => t.id === id);
  if (!t) return;
  t.status = t.status === 'completed' ? 'pending' : 'completed';
  t.updated_at = Date.now();
  if (t.status === 'completed') {
    markStreakToday();
    addNotification(`âœ… Completed: "${t.title}"`, 'success');
    toast('Task completed! ğŸ‰', 'success');
  }
  saveUserData();
  renderTasks();
}
function openEditModal(id) {
  const t = tasks.find(t => t.id === id);
  if (!t) return;
  editingTaskId = id;
  document.getElementById('editTitle').value = t.title;
  document.getElementById('editSubject').value = t.subject || '';
  document.getElementById('editDue').value = t.due || '';
  document.getElementById('editPriority').value = t.priority;
  document.getElementById('editStatus').value = t.status;
  document.getElementById('editNotes').value = t.notes || '';
  document.getElementById('editModal').classList.add('show');
}
function saveEdit() {
  const t = tasks.find(t => t.id === editingTaskId);
  if (!t) return;
  const title = document.getElementById('editTitle').value.trim();
  if (!title) return;
  t.title = title;
  t.subject = document.getElementById('editSubject').value.trim();
  t.due = document.getElementById('editDue').value;
  t.priority = document.getElementById('editPriority').value;
  t.status = document.getElementById('editStatus').value;
  t.notes = document.getElementById('editNotes').value.trim();
  t.updated_at = Date.now();
  saveUserData();
  closeModal('editModal');
  toast('Task updated!', 'success');
  renderTasks();
}
function closeModal(id) { document.getElementById(id).classList.remove('show'); }
document.getElementById('editModal').addEventListener('click', e => { if (e.target.id === 'editModal') closeModal('editModal'); });
document.addEventListener('keydown', e => { if (e.key === 'Escape') { closeModal('editModal'); document.getElementById('themePanel').classList.remove('show'); document.getElementById('notifPanel').classList.remove('show'); }});

/* â”€â”€â”€ FILTER & SEARCH â”€â”€â”€ */
function setFilter(f, el) {
  currentFilter = f;
  document.querySelectorAll('.fc').forEach(b => b.classList.remove('active'));
  el.classList.add('active');
  renderTasks();
}
function getFilteredTasks() {
  const search = (document.getElementById('taskSearch')?.value || '').toLowerCase();
  return tasks.filter(t => {
    const matchSearch = !search || t.title.toLowerCase().includes(search) || (t.subject||'').toLowerCase().includes(search) || (t.notes||'').toLowerCase().includes(search);
    const matchFilter = currentFilter === 'all' || (currentFilter === 'completed' ? t.status === 'completed' : t.priority === currentFilter);
    return matchSearch && matchFilter;
  });
}
function isOverdue(t) {
  if (!t.due || t.status === 'completed') return false;
  return new Date(t.due) < new Date(new Date().toDateString());
}

/* â”€â”€â”€ RENDER TASKS â”€â”€â”€ */
function renderTasks() {
  const grid = document.getElementById('tasksGrid');
  const filtered = getFilteredTasks();
  if (!filtered.length) {
    grid.innerHTML = `<div class="empty-state" style="grid-column:1/-1"><div class="es-icon">ğŸ“‹</div><div class="es-title">No tasks found</div><div class="es-sub">Try adjusting your filters or add a new task.</div></div>`;
    return;
  }
  grid.innerHTML = filtered.map(t => {
    const overdue = isOverdue(t);
    const pCls = `pill pill-${t.priority}`;
    const sCls = `pill pill-${overdue ? 'overdue' : t.status}`;
    const sLabel = overdue ? 'âš  Overdue' : t.status === 'in-progress' ? 'In Progress' : t.status === 'completed' ? 'Completed' : 'Pending';
    const dueStr = t.due ? `ğŸ“… ${new Date(t.due+'T00:00:00').toLocaleDateString('en-GB',{day:'numeric',month:'short',year:'numeric'})}` : '';
    const subtasksHtml = t.subtasks?.length ? `<div class="subtasks-wrap">${t.subtasks.map((st,i) => `<div class="subtask-item" onclick="toggleSubtask('${t.id}',${i})"><div class="subtask-cb${st.done?' checked':''}">${st.done?'âœ“':''}</div><span class="subtask-txt${st.done?' checked':''}">${escHtml(st.text)}</span></div>`).join('')}</div>` : '';
    return `<div class="task-card tc-${t.priority}${overdue?' tc-overdue':''}">
      <div class="tc-header">
        <div class="tc-title${t.status==='completed'?' completed-title':''}">${escHtml(t.title)}</div>
        <div class="tc-actions">
          <button class="icon-btn complete-btn" onclick="toggleComplete('${t.id}')" title="${t.status==='completed'?'Mark pending':'Mark complete'}">${t.status==='completed'?'â†©':'âœ“'}</button>
          <button class="icon-btn" onclick="openEditModal('${t.id}')" title="Edit">âœ</button>
          <button class="icon-btn delete-btn" onclick="deleteTask('${t.id}')" title="Delete">âœ•</button>
        </div>
      </div>
      <div class="tc-meta">
        <span class="${pCls}">${t.priority}</span>
        <span class="${sCls}">${sLabel}</span>
        ${t.subject ? `<span class="tc-subject">ğŸ“š ${escHtml(t.subject)}</span>` : ''}
      </div>
      ${t.due ? `<div class="tc-due${overdue?' overdue':''}">${dueStr}</div>` : ''}
      ${t.notes ? `<div class="tc-desc">${escHtml(t.notes)}</div>` : ''}
      ${subtasksHtml}
      <div class="tc-footer">
        <span style="font-size:0.72rem;color:var(--tx4)">${new Date(t.updated_at).toLocaleDateString()}</span>
        <button class="ai-subtask-btn" onclick="generateSubtasks('${t.id}')">âœ¨ AI Subtasks</button>
      </div>
    </div>`;
  }).join('');
}
function toggleSubtask(taskId, idx) {
  const t = tasks.find(t => t.id === taskId);
  if (!t || !t.subtasks[idx]) return;
  t.subtasks[idx].done = !t.subtasks[idx].done;
  t.updated_at = Date.now();
  saveUserData();
  renderTasks();
}

/* â”€â”€â”€ RENDER DASHBOARD â”€â”€â”€ */
function renderDashboard() {
  const total = tasks.length;
  const done = tasks.filter(t => t.status === 'completed').length;
  const pending = tasks.filter(t => t.status === 'pending').length;
  const inProg = tasks.filter(t => t.status === 'in-progress').length;
  const high = tasks.filter(t => t.priority === 'high' && t.status !== 'completed').length;
  const overdue = tasks.filter(isOverdue).length;
  const pct = total ? Math.round((done/total)*100) : 0;
  document.getElementById('kpiGrid').innerHTML = [
    {cls:'k-total',icon:'ğŸ“‹',val:total,label:'Total Tasks'},
    {cls:'k-done',icon:'âœ…',val:done,label:'Completed'},
    {cls:'k-pending',icon:'â³',val:pending,label:'Pending'},
    {cls:'k-progress',icon:'ğŸ”„',val:inProg,label:'In Progress'},
    {cls:'k-high',icon:'ğŸ”´',val:high,label:'High Priority'},
    {cls:'k-overdue',icon:'âš ï¸',val:overdue,label:'Overdue'},
  ].map(k => `<div class="kpi-card ${k.cls}"><div class="kpi-icon">${k.icon}</div><div class="kpi-val">${k.val}</div><div class="kpi-label">${k.label}</div></div>`).join('');

  // Ring
  const offset = 251 - (pct / 100) * 251;
  const ring = document.getElementById('ringFg');
  ring.style.strokeDashoffset = offset;
  document.getElementById('ringPct').textContent = pct + '%';

  // Recent
  const recent = [...tasks].sort((a,b) => b.updated_at - a.updated_at).slice(0,7);
  const rl = document.getElementById('recentList');
  const recentHtml = recent.map(t => {
    const col = t.priority === 'high' ? 'var(--acc-r)' : t.priority === 'medium' ? 'var(--acc-y)' : 'var(--acc-g)';
    return `<div class="recent-item">
      <div class="ri-dot" style="background:${col}"></div>
      <div class="ri-info"><div class="ri-title">${escHtml(t.title)}</div><div class="ri-sub">${t.subject || 'No subject'} Â· ${new Date(t.updated_at).toLocaleDateString()}</div></div>
      <div class="ri-status"><span class="pill pill-${t.status==='completed'?'completed':t.status === 'in-progress'?'in-progress':'pending'}">${t.status}</span></div>
    </div>`;
  }).join('') || '<div style="color:var(--tx3);font-size:0.875rem;padding:12px 0">No tasks yet. Add your first task!</div>';
  rl.innerHTML = `<div style="font-weight:700;font-size:0.9rem;margin-bottom:14px;color:var(--tx2)">Recent Activity</div>${recentHtml}`;

  rebuildCharts();
  renderStreak();
}

function rebuildCharts() {
  const done = tasks.filter(t => t.status === 'completed').length;
  const inProg = tasks.filter(t => t.status === 'in-progress').length;
  const pending = tasks.filter(t => t.status === 'pending').length;
  const cs = getComputedStyle(document.documentElement);
  const acc = cs.getPropertyValue('--acc').trim();
  const accG = cs.getPropertyValue('--acc-g').trim();
  const accY = cs.getPropertyValue('--acc-y').trim();
  const bg4 = cs.getPropertyValue('--bg4').trim();

  if (donutChart) donutChart.destroy();
  const dc = document.getElementById('donutChart');
  if (dc) donutChart = new Chart(dc, {
    type:'doughnut',
    data:{labels:['Completed','In Progress','Pending'],datasets:[{data:[done,inProg,pending],backgroundColor:[accG,acc,bg4],borderWidth:0,hoverOffset:6}]},
    options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{color:cs.getPropertyValue('--tx2').trim(),padding:14,font:{size:12}}}}}
  });
}

/* â”€â”€â”€ STREAK â”€â”€â”€ */
function markStreakToday() {
  const streakKey = `streak_${currentUser.email}`;
  const streak = get(streakKey) || {};
  const today = new Date().toDateString();
  streak[today] = true;
  set(streakKey, streak);
}
function renderStreak() {
  const streakKey = `streak_${currentUser.email}`;
  const streak = get(streakKey) || {};
  const days = [];
  let count = 0;
  for (let i = 6; i >= 0; i--) {
    const d = new Date();
    d.setDate(d.getDate() - i);
    const key = d.toDateString();
    const active = !!streak[key];
    const today = i === 0;
    if (active && (today || count > 0 || days.slice(-1)[0]?.active)) count++;
    else if (!active && count > 0 && !today) count = 0;
    days.push({ key, active, today, label: d.toLocaleDateString('en',{weekday:'short'}).slice(0,2), day: d.getDate() });
  }
  let streak_count = 0;
  for (let i = 6; i >= 0; i--) {
    if (streak[new Date(Date.now() - i * 86400000).toDateString()]) streak_count++;
    else if (i < 6) break;
  }
  document.getElementById('streakCount').textContent = Object.keys(streak).length;
  document.getElementById('streakDots').innerHTML = days.map(d => `<div class="s-dot${d.active?' active':''}${d.today?' today':''}"><span style="font-size:0.6rem">${d.label}</span><span>${d.day}</span></div>`).join('');
}

/* â”€â”€â”€ UPCOMING â”€â”€â”€ */
function renderUpcoming() {
  const today = new Date();
  const in14 = new Date(Date.now() + 14 * 86400000);
  const upcoming = tasks.filter(t => {
    if (!t.due || t.status === 'completed') return false;
    const d = new Date(t.due + 'T00:00:00');
    return d <= in14;
  }).sort((a,b) => new Date(a.due) - new Date(b.due));
  const tl = document.getElementById('upcomingTimeline');
  if (!upcoming.length) {
    tl.innerHTML = `<div class="empty-state"><div class="es-icon">ğŸ“…</div><div class="es-title">All clear!</div><div class="es-sub">No upcoming deadlines in the next 14 days.</div></div>`;
    return;
  }
  tl.innerHTML = upcoming.map(t => {
    const d = new Date(t.due + 'T00:00:00');
    const ov = d < today;
    const tod = d.toDateString() === today.toDateString();
    const dotCls = ov ? 'overdue' : tod ? 'today' : '';
    const dateLabel = ov ? 'âš  Overdue' : tod ? 'ğŸ“ Today' : d.toLocaleDateString('en-GB',{weekday:'long',day:'numeric',month:'long'});
    return `<div class="tl-item"><div class="tl-dot ${dotCls}"></div><div class="tl-content">
      <div class="tl-date">${dateLabel}</div>
      <div class="tl-title">${escHtml(t.title)}</div>
      <div class="tl-meta"><span class="pill pill-${t.priority}">${t.priority}</span>${t.subject?`<span style="font-size:0.78rem;color:var(--tx3)">ğŸ“š ${escHtml(t.subject)}</span>`:''}</div>
    </div></div>`;
  }).join('');
}

/* â”€â”€â”€ PERFORMANCE â”€â”€â”€ */
function renderPerformance() {
  const total = tasks.length;
  const done = tasks.filter(t => t.status === 'completed').length;
  const today = new Date().toDateString();
  const dueToday = tasks.filter(t => t.due && new Date(t.due + 'T00:00:00').toDateString() === today);
  const onTimeDone = tasks.filter(t => t.status === 'completed' && t.due && new Date(t.due + 'T00:00:00') >= new Date(t.updated_at - 86400000)).length;
  const completionRate = total ? Math.round((done/total)*100) : 0;
  const onTimeRate = done ? Math.round((onTimeDone/done)*100) : 0;
  const highDone = tasks.filter(t => t.priority === 'high' && t.status === 'completed').length;
  const highTotal = tasks.filter(t => t.priority === 'high').length;
  const grade = completionRate >= 90?'A+':completionRate >= 80?'A':completionRate >= 70?'B':completionRate >= 60?'C':'D';
  document.getElementById('perfGrid').innerHTML = [
    {val:`${completionRate}%`,label:'Completion Rate'},
    {val:`${onTimeRate}%`,label:'On-Time Rate'},
    {val:`${highDone}/${highTotal}`,label:'High Priority Done'},
    {val:grade,label:'Overall Grade'},
  ].map(s => `<div class="perf-stat card"><div class="perf-val">${s.val}</div><div class="perf-label">${s.label}</div></div>`).join('');

  // Subject bars
  const subjects = {};
  tasks.forEach(t => {
    const s = t.subject || 'General';
    if (!subjects[s]) subjects[s] = { total:0, done:0 };
    subjects[s].total++;
    if (t.status === 'completed') subjects[s].done++;
  });
  const sbContainer = document.getElementById('subjectBars');
  sbContainer.innerHTML = `<div class="chart-title" style="margin-bottom:12px">Subject Progress</div>` +
    (Object.keys(subjects).length ? Object.entries(subjects).map(([s,v]) => {
      const pct = Math.round((v.done/v.total)*100);
      return `<div class="subject-bar-item"><div class="sb-header"><span>${escHtml(s)}</span><span>${v.done}/${v.total} (${pct}%)</span></div><div class="sb-track"><div class="sb-fill" style="width:${pct}%"></div></div></div>`;
    }).join('') : '<div style="color:var(--tx3);font-size:0.875rem">No subjects yet.</div>');

  // Heatmap
  const streakKey = `streak_${currentUser.email}`;
  const streak = get(streakKey) || {};
  const hm = document.getElementById('heatmap');
  const cells = [];
  for (let i = 27; i >= 0; i--) {
    const d = new Date(Date.now() - i * 86400000);
    const key = d.toDateString();
    const hasDone = tasks.some(t => t.status === 'completed' && new Date(t.updated_at).toDateString() === key);
    const lvl = streak[key] || hasDone ? (hasDone ? (Math.random() > 0.5 ? 3 : 2) : 1) : 0;
    cells.push(`<div class="hm-cell hm-${lvl}" title="${d.toLocaleDateString()}" style="animation-delay:${(27-i)*0.02}s"></div>`);
  }
  hm.innerHTML = cells.join('');

  // Weekly bar chart
  const weeks = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
  const weekCounts = weeks.map((_,i) => {
    const d = new Date();
    const day = d.getDay();
    const diff = ((i + 1) - day + 7) % 7;
    const td = new Date(d.getTime() - ((6 - diff) * 86400000));
    return tasks.filter(t => t.status === 'completed' && new Date(t.updated_at).toDateString() === td.toDateString()).length;
  });
  if (barChart) barChart.destroy();
  const cs = getComputedStyle(document.documentElement);
  const bc = document.getElementById('barChart');
  if (bc) barChart = new Chart(bc, {
    type:'bar',
    data:{ labels:weeks, datasets:[{ label:'Completed', data:weekCounts, backgroundColor:cs.getPropertyValue('--acc').trim()+'80', borderColor:cs.getPropertyValue('--acc').trim(), borderWidth:2, borderRadius:6 }] },
    options:{ responsive:true, maintainAspectRatio:false, plugins:{ legend:{display:false} }, scales:{ x:{ticks:{color:cs.getPropertyValue('--tx3').trim()},grid:{color:'transparent'}}, y:{ticks:{color:cs.getPropertyValue('--tx3').trim(),stepSize:1},grid:{color:cs.getPropertyValue('--bg4').trim()+'80'}} } }
  });
}

/* â”€â”€â”€ NOTIFICATIONS â”€â”€â”€ */
function loadNotifications() {
  notifications = get(`notifs_${currentUser.email}`) || [];
}
function saveNotifications() {
  if (notifications.length > 30) notifications = notifications.slice(-30);
  set(`notifs_${currentUser.email}`, notifications);
}
function addNotification(title, type = 'info') {
  if (!currentUser) return;
  loadNotifications();
  notifications.unshift({ id: Date.now().toString(), title, type, time: Date.now(), read: false });
  saveNotifications();
  updateNotifBadge();
}
function checkNotifications() {
  if (!currentUser) return;
  loadNotifications();
  const today = new Date().toDateString();
  const tomorrow = new Date(Date.now() + 86400000).toDateString();
  tasks.forEach(t => {
    if (!t.due || t.status === 'completed') return;
    const due = new Date(t.due + 'T00:00:00').toDateString();
    const existing = notifications.find(n => n.title.includes(t.title) && n.time > Date.now() - 86400000);
    if (!existing) {
      if (due === today) addNotification(`ğŸ“ Due today: "${t.title}"`, 'warn');
      else if (due === tomorrow) addNotification(`â° Due tomorrow: "${t.title}"`, 'warn');
      else if (isOverdue(t)) addNotification(`âš ï¸ Overdue: "${t.title}"`, 'error');
    }
  });
  updateNotifBadge();
  renderNotifPanel();
}
function updateNotifBadge() {
  loadNotifications();
  const unread = notifications.filter(n => !n.read).length;
  const badge = document.getElementById('notifBadge');
  badge.textContent = unread > 9 ? '9+' : unread;
  badge.classList.toggle('show', unread > 0);
}
function renderNotifPanel() {
  const list = document.getElementById('npList');
  if (!notifications.length) { list.innerHTML = '<div class="np-empty">No notifications</div>'; return; }
  list.innerHTML = notifications.slice(0,15).map(n => `<div class="np-item${n.read?'':' unread'}"><div class="np-item-title">${escHtml(n.title)}</div><div class="np-item-sub">${new Date(n.time).toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})}</div></div>`).join('');
}
function toggleNotifPanel() {
  loadNotifications();
  notifications.forEach(n => n.read = true);
  saveNotifications();
  updateNotifBadge();
  renderNotifPanel();
  document.getElementById('notifPanel').classList.toggle('show');
  document.getElementById('themePanel').classList.remove('show');
}
function clearNotifs() {
  notifications = [];
  saveNotifications();
  updateNotifBadge();
  renderNotifPanel();
  document.getElementById('notifPanel').classList.remove('show');
}

/* â”€â”€â”€ TOAST â”€â”€â”€ */
function toast(msg, type = 'info') {
  const t = document.createElement('div');
  t.className = `toast ${type}`;
  t.innerHTML = `<span>${type === 'success'?'âœ…':type === 'error'?'âŒ':'â„¹ï¸'}</span><span>${escHtml(msg)}</span>`;
  document.getElementById('toastContainer').appendChild(t);
  setTimeout(() => { t.style.animation = 'toastOut 0.3s ease forwards'; setTimeout(() => t.remove(), 300); }, 3000);
}

/* â”€â”€â”€ AI CHAT â”€â”€â”€ */
function sendChip(msg) {
  document.getElementById('aiInput').value = msg;
  sendAIMessage();
}
async function sendAIMessage() {
  const input = document.getElementById('aiInput');
  const msg = input.value.trim();
  if (!msg) return;
  input.value = '';
  appendMessage('user', msg, true);
  chatHistory.push({ role:'user', content: msg });
  showTyping(true);

  try {
    const taskSummary = tasks.map(t => `- "${t.title}" [${t.priority}/${t.status}]${t.due?' due '+t.due:''}`).join('\n') || 'No tasks yet.';
    const systemPrompt = `You are StudyBot AI, a smart study assistant for students. The user's name is ${currentUser.name}. Here are their current tasks:\n${taskSummary}\n\nGive concise, helpful, motivating answers. Keep responses under 150 words.`;

    let replyText = '';

    // Try fetch to backend /api/ai/chat first
    try {
      const res = await fetch('/api/ai/chat', {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ message: msg, history: chatHistory.slice(-6), system: systemPrompt })
      });
      if (res.ok) {
        const data = await res.json();
        replyText = data.reply || data.content || '';
      }
    } catch(e) {}

    // Fallback: Groq direct (if key set)
    if (!replyText && GROQ_API_KEY) {
      const res = await fetch('https://api.groq.com/openai/v1/chat/completions', {
        method:'POST',
        headers:{'Authorization':'Bearer '+GROQ_API_KEY,'Content-Type':'application/json'},
        body: JSON.stringify({ model:'llama3-8b-8192', messages:[{role:'system',content:systemPrompt},...chatHistory.slice(-8).map(m=>({role:m.role==='bot'?'assistant':m.role,content:m.content}))], max_tokens:200 })
      });
      const d = await res.json();
      replyText = d.choices?.[0]?.message?.content || '';
    }

    // Smart local fallback
    if (!replyText) replyText = localAIReply(msg);

    showTyping(false);
    appendMessage('bot', replyText, true);
    chatHistory.push({ role:'bot', content: replyText });
    if (chatHistory.length > 20) chatHistory = chatHistory.slice(-20);
    set(`chat_${currentUser.email}`, chatHistory);
  } catch(e) {
    showTyping(false);
    appendMessage('bot', 'âš ï¸ Connection issue. ' + localAIReply(msg), true);
  }
}
function localAIReply(msg) {
  const m = msg.toLowerCase();
  const high = tasks.filter(t => t.priority === 'high' && t.status !== 'completed');
  const overdue = tasks.filter(isOverdue);
  const done = tasks.filter(t => t.status === 'completed').length;
  const total = tasks.length;
  if (m.includes('focus') || m.includes('today')) {
    if (overdue.length) return `âš ï¸ You have ${overdue.length} overdue task(s)! Start with: "${overdue[0].title}". Tackle that first before anything else.`;
    if (high.length) return `ğŸ¯ Focus on your high priority tasks. Start with "${high[0].title}". You've got this!`;
    return `âœ… Looking good! No urgent tasks right now. Keep your momentum going!`;
  }
  if (m.includes('overload') || m.includes('busy') || m.includes('stress')) {
    const pending = tasks.filter(t => t.status !== 'completed').length;
    return pending > 10 ? `You have ${pending} open tasks â€” that is a heavy load! Break them into 2-3 focus sessions per day.` : `You have ${pending} open tasks. That's manageable! Prioritise high-priority items first.`;
  }
  if (m.includes('plan') || m.includes('schedule')) return `ğŸ“… Study plan: Morning â€” tackle your hardest/highest priority task. Afternoon â€” medium priority work. Evening â€” review and plan tomorrow. Aim for 3-4 focused tasks per day!`;
  if (m.includes('high priority') || m.includes('urgent')) return high.length ? `ğŸ”´ High priority tasks: ${high.map(t=>`"${t.title}"`).join(', ')}. Focus on these first!` : 'âœ… Great news â€” no high priority tasks pending!';
  if (m.includes('progress') || m.includes('how am i')) return total ? `ğŸ“Š You've completed ${done}/${total} tasks (${Math.round(done/total*100)}%). ${done >= total*0.7?'Excellent work! ğŸŒŸ':'Keep pushing â€” you are on track! ğŸ’ª'}` : 'Add your first task to start tracking progress!';
  return `I'm here to help! You can ask me about your tasks, study plans, what to focus on, or how to manage your workload. What would you like to know?`;
}
function appendMessage(role, content, save) {
  const msgs = document.getElementById('aiMessages');
  const typing = document.getElementById('typingIndicator');
  const div = document.createElement('div');
  div.className = `msg ${role}`;
  div.innerHTML = `<div class="msg-bubble">${escHtml(content)}</div><div class="msg-time">${new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})}</div>`;
  msgs.insertBefore(div, typing);
  msgs.scrollTop = msgs.scrollHeight;
}
function showTyping(show) { document.getElementById('typingIndicator').style.display = show ? 'flex' : 'none'; }

/* â”€â”€â”€ AI PRIORITY & SUBTASKS â”€â”€â”€ */
async function aiSuggestPriority() {
  const title = document.getElementById('taskTitle').value.trim();
  if (!title) { toast('Enter a title first!', 'error'); return; }
  const btn = document.querySelector('.ai-prio-btn');
  btn.textContent = 'â³ Thinking...';
  btn.disabled = true;
  await new Promise(r => setTimeout(r, 800));
  // Smart rule-based fallback
  const m = title.toLowerCase();
  const prio = (m.includes('exam') || m.includes('deadline') || m.includes('urgent') || m.includes('submit') || m.includes('final')) ? 'high' : (m.includes('review') || m.includes('read') || m.includes('practice') || m.includes('prepare')) ? 'medium' : 'low';
  document.getElementById('taskPriority').value = prio;
  const result = document.getElementById('aiPrioResult');
  result.style.display = 'inline';
  result.textContent = `â†’ Suggested: ${prio}`;
  btn.textContent = 'âœ¨ AI Suggest Priority';
  btn.disabled = false;
  toast(`AI suggested ${prio} priority!`, 'success');
}
async function generateSubtasks(taskId) {
  const t = tasks.find(t => t.id === taskId);
  if (!t) return;
  toast('Generating subtasks...', 'info');
  await new Promise(r => setTimeout(r, 600));
  // Smart local subtask generation
  const m = t.title.toLowerCase();
  let subtasks = [];
  if (m.includes('essay') || m.includes('report') || m.includes('write')) subtasks = ['Research the topic','Create an outline','Write the first draft','Proofread and edit','Final review & submit'];
  else if (m.includes('math') || m.includes('calculus') || m.includes('algebra')) subtasks = ['Review relevant formulas','Solve practice problems','Check answers and errors','Summarise key methods'];
  else if (m.includes('code') || m.includes('program') || m.includes('project')) subtasks = ['Plan the architecture','Set up the environment','Implement core features','Write tests','Review and debug'];
  else if (m.includes('study') || m.includes('revise') || m.includes('review')) subtasks = ['Gather notes and materials','Read through chapter/topic','Make summary notes','Test yourself with questions'];
  else subtasks = ['Understand the requirements','Research and gather resources','Create an action plan','Complete the work','Review before submitting'];
  t.subtasks = subtasks.map(text => ({ text, done: false }));
  t.updated_at = Date.now();
  saveUserData();
  renderTasks();
  toast(`Generated ${subtasks.length} subtasks! ğŸ‰`, 'success');
}

/* â”€â”€â”€ CLOSE PANELS ON OUTSIDE CLICK â”€â”€â”€ */
document.addEventListener('click', e => {
  const np = document.getElementById('notifPanel');
  const nb = document.getElementById('notifBtn');
  const tp = document.getElementById('themePanel');
  if (!np.contains(e.target) && !nb.contains(e.target)) np.classList.remove('show');
  if (!tp.contains(e.target) && !e.target.closest('[onclick="toggleThemePanel()"]')) tp.classList.remove('show');
});
</script>
</body>
</html>